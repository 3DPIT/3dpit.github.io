{"componentChunkName":"component---src-templates-blog-post-js","path":"/PoC/2022-07-18-Topshelf에대한-기능조사와-간단한-서비스생성/","result":{"data":{"site":{"siteMetadata":{"title":"3DPIT Study Blog","author":"[KyeongMinPark]","siteUrl":"https://3dpit.github.io","comment":{"disqusShortName":"","utterances":"3dpit/3dpit.github.io"},"sponsor":{"buyMeACoffeeId":""}}},"markdownRemark":{"id":"b31e6e3d-e5fc-56c1-9f72-99f013952d1f","excerpt":"2022-07-18-Topshelf에대한-기능조사와-간단한-서비스생성 목차 01.Topshelf를 사용하는 이유 02.Topshelf 구성 확인하기 02.1 서비스이름 02.2 서비스 설명 02.3 이름 표시하기 02.4 인스턴스 이름 02.5 간단한 서비스 03.Topshelf 사용해보기 03.1 프로젝트 생성후 Topshelf패키지 설치 03.2 서비스 테스트를 위한 소스 구현 03.3 서비스 설치 01.Topshelf…","html":"<h2 id=\"2022-07-18-topshelf에대한-기능조사와-간단한-서비스생성\" style=\"position:relative;\"><a href=\"#2022-07-18-topshelf%EC%97%90%EB%8C%80%ED%95%9C-%EA%B8%B0%EB%8A%A5%EC%A1%B0%EC%82%AC%EC%99%80-%EA%B0%84%EB%8B%A8%ED%95%9C-%EC%84%9C%EB%B9%84%EC%8A%A4%EC%83%9D%EC%84%B1\" aria-label=\"2022 07 18 topshelf에대한 기능조사와 간단한 서비스생성 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2022-07-18-Topshelf에대한-기능조사와-간단한-서비스생성</h2>\n<h2 id=\"목차\" style=\"position:relative;\"><a href=\"#%EB%AA%A9%EC%B0%A8\" aria-label=\"목차 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>목차</h2>\n<blockquote>\n<p>01.Topshelf를 사용하는 이유</p>\n<p>02.Topshelf 구성 확인하기</p>\n<blockquote>\n<p>02.1 서비스이름</p>\n<p>02.2 서비스 설명</p>\n<p>02.3 이름 표시하기</p>\n<p>02.4 인스턴스 이름</p>\n<p>02.5 간단한 서비스</p>\n</blockquote>\n<p>03.Topshelf 사용해보기</p>\n<blockquote>\n<p>03.1 프로젝트 생성후 Topshelf패키지 설치</p>\n<p>03.2 서비스 테스트를 위한 소스 구현</p>\n<p>03.3 서비스 설치</p>\n</blockquote>\n</blockquote>\n<h2 id=\"01topshelf를-사용하는-이유\" style=\"position:relative;\"><a href=\"#01topshelf%EB%A5%BC-%EC%82%AC%EC%9A%A9%ED%95%98%EB%8A%94-%EC%9D%B4%EC%9C%A0\" aria-label=\"01topshelf를 사용하는 이유 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>01.Topshelf를 사용하는 이유</h2>\n<ul>\n<li>윈도우 서비스는 디버깅이 힘듦</li>\n<li>\n<p>디버깅을 하려고 하면 항상 경고창이 나타나서 꼼수를 이용하여 디버깅을 함</p>\n<div class=\"gatsby-highlight\" data-language=\"csharp\"><pre class=\"language-csharp\"><code class=\"language-csharp\"><span class=\"token keyword\">static</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Program</span>\n<span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">static</span> <span class=\"token return-type class-name\"><span class=\"token keyword\">void</span></span> <span class=\"token function\">Main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">{</span>\n<span class=\"token preprocessor property\">#<span class=\"token directive keyword\">if</span> DEBUG</span>\n      <span class=\"token class-name\"><span class=\"token keyword\">var</span></span> service <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">SampleService</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      service<span class=\"token punctuation\">.</span><span class=\"token function\">Start</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token preprocessor property\">#<span class=\"token directive keyword\">else</span></span>\n      ServiceBase\\<span class=\"token punctuation\">[</span>\\<span class=\"token punctuation\">]</span> ServicesToRun<span class=\"token punctuation\">;</span>\n      ServicesToRun <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> ServiceBase\\<span class=\"token punctuation\">[</span>\\<span class=\"token punctuation\">]</span> \n      <span class=\"token punctuation\">{</span> \n          <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">SampleService</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> \n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n      ServiceBase<span class=\"token punctuation\">.</span><span class=\"token function\">Run</span><span class=\"token punctuation\">(</span>ServicesToRun<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token preprocessor property\">#<span class=\"token directive keyword\">endif</span></span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li>위의 방식 자체가 틀린건 아니지만 최선은 아님</li>\n<li>Topshelf 자체가 훨씬 더 편리하게 타이머 적용할 수 있어서 윈도우 서비스를 특정 시간대에만 작동할 수도 있다는 장점있음</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"02topshelf-구성-확인하기\" style=\"position:relative;\"><a href=\"#02topshelf-%EA%B5%AC%EC%84%B1-%ED%99%95%EC%9D%B8%ED%95%98%EA%B8%B0\" aria-label=\"02topshelf 구성 확인하기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>02.Topshelf 구성 확인하기</h2>\n<h3 id=\"021-서비스이름\" style=\"position:relative;\"><a href=\"#021-%EC%84%9C%EB%B9%84%EC%8A%A4%EC%9D%B4%EB%A6%84\" aria-label=\"021 서비스이름 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>02.1 서비스이름</h3>\n<ul>\n<li>\n<p>위의 설정은 선택사항</p>\n<ul>\n<li>기본적으로는 Program.cs파일의 네임스페이스를 사용함</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"csharp\"><pre class=\"language-csharp\"><code class=\"language-csharp\">x<span class=\"token punctuation\">.</span><span class=\"token function\">SetServiceName</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"MyService\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n</li>\n</ul>\n<h3 id=\"022-서비스-설명\" style=\"position:relative;\"><a href=\"#022-%EC%84%9C%EB%B9%84%EC%8A%A4-%EC%84%A4%EB%AA%85\" aria-label=\"022 서비스 설명 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>02.2 서비스 설명</h3>\n<ul>\n<li>\n<p>서비스 제어 관리자에서 서비스에 대한 설명 지정</p>\n<ul>\n<li>선택사항이고 , 기본적으로 서비스 이름임</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"csharp\"><pre class=\"language-csharp\"><code class=\"language-csharp\">x<span class=\"token punctuation\">.</span><span class=\"token function\">SetDescription</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"My First Topshelf Service\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n</li>\n</ul>\n<h3 id=\"023-이름-표시하기\" style=\"position:relative;\"><a href=\"#023-%EC%9D%B4%EB%A6%84-%ED%91%9C%EC%8B%9C%ED%95%98%EA%B8%B0\" aria-label=\"023 이름 표시하기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>02.3 이름 표시하기</h3>\n<ul>\n<li>\n<p>서비스 제어 관리자에서 서비스의 표시 이름을 지정</p>\n<ul>\n<li>선택사항이고, 기본적으로 서비스 이름임</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"csharp\"><pre class=\"language-csharp\"><code class=\"language-csharp\">x<span class=\"token punctuation\">.</span><span class=\"token function\">SetDisplayName</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"MyService\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n</li>\n</ul>\n<h3 id=\"024-인스턴스-이름\" style=\"position:relative;\"><a href=\"#024-%EC%9D%B8%EC%8A%A4%ED%84%B4%EC%8A%A4-%EC%9D%B4%EB%A6%84\" aria-label=\"024 인스턴스 이름 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>02.4 인스턴스 이름</h3>\n<ul>\n<li>\n<p>기본 서비스 이름과 결합됨 $로 구분되는 서비스의 인스턴스 이름을 지정</p>\n<ul>\n<li>이것은 선택사항이고 지정된 경우에만 추가</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"csharp\"><pre class=\"language-csharp\"><code class=\"language-csharp\">x<span class=\"token punctuation\">.</span><span class=\"token function\">SetInstanceName</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"MyService\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n</li>\n</ul>\n<h3 id=\"025-간단한-서비스\" style=\"position:relative;\"><a href=\"#025-%EA%B0%84%EB%8B%A8%ED%95%9C-%EC%84%9C%EB%B9%84%EC%8A%A4\" aria-label=\"025 간단한 서비스 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>02.5 간단한 서비스</h3>\n<ul>\n<li>\n<p>기본틀</p>\n<div class=\"gatsby-highlight\" data-language=\"csharp\"><pre class=\"language-csharp\"><code class=\"language-csharp\">HostFactory<span class=\"token punctuation\">.</span><span class=\"token function\">New</span><span class=\"token punctuation\">(</span>x <span class=\"token operator\">=></span>\n<span class=\"token punctuation\">{</span>\n  x<span class=\"token punctuation\">.</span><span class=\"token generic-method\"><span class=\"token function\">Service</span><span class=\"token generic class-name\"><span class=\"token punctuation\">&lt;</span>MyService<span class=\"token punctuation\">></span></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// Service implements the ServiceControl methods directly and has a default constructor</span>\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">MyService</span> <span class=\"token punctuation\">:</span> <span class=\"token type-list\"><span class=\"token class-name\">ServiceControl</span></span>\n<span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span></code></pre></div>\n</li>\n<li>\n<p>실제 사용</p>\n<div class=\"gatsby-highlight\" data-language=\"csharp\"><pre class=\"language-csharp\"><code class=\"language-csharp\"><span class=\"token class-name\"><span class=\"token keyword\">var</span></span> rc <span class=\"token operator\">=</span> HostFactory<span class=\"token punctuation\">.</span><span class=\"token function\">Run</span><span class=\"token punctuation\">(</span>x <span class=\"token operator\">=></span>                                   <span class=\"token comment\">//1</span>\n                       <span class=\"token punctuation\">{</span>\n                           x<span class=\"token punctuation\">.</span><span class=\"token generic-method\"><span class=\"token function\">Service</span><span class=\"token generic class-name\"><span class=\"token punctuation\">&lt;</span>TownCrier<span class=\"token punctuation\">></span></span></span><span class=\"token punctuation\">(</span>s <span class=\"token operator\">=></span>                                   <span class=\"token comment\">//2</span>\n                                                <span class=\"token punctuation\">{</span>\n                                                    s<span class=\"token punctuation\">.</span><span class=\"token function\">ConstructUsing</span><span class=\"token punctuation\">(</span>name <span class=\"token operator\">=></span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">TownCrier</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>                <span class=\"token comment\">//3</span>\n                                                    s<span class=\"token punctuation\">.</span><span class=\"token function\">WhenStarted</span><span class=\"token punctuation\">(</span>tc <span class=\"token operator\">=></span> tc<span class=\"token punctuation\">.</span><span class=\"token function\">Start</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>                         <span class=\"token comment\">//4</span>\n                                                    s<span class=\"token punctuation\">.</span><span class=\"token function\">WhenStopped</span><span class=\"token punctuation\">(</span>tc <span class=\"token operator\">=></span> tc<span class=\"token punctuation\">.</span><span class=\"token function\">Stop</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>                          <span class=\"token comment\">//5</span>\n                                                <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                           x<span class=\"token punctuation\">.</span><span class=\"token function\">RunAsLocalSystem</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>                                       <span class=\"token comment\">//6</span>\n\n                           x<span class=\"token punctuation\">.</span><span class=\"token function\">SetDescription</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"ABC Desc Sample Topshelf Host\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>                   <span class=\"token comment\">//7</span>\n                           x<span class=\"token punctuation\">.</span><span class=\"token function\">SetDisplayName</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"ABC DisplayName Stuff\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>                                  <span class=\"token comment\">//8</span>\n                           x<span class=\"token punctuation\">.</span><span class=\"token function\">SetServiceName</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"ABC ServiceName Stuff\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>                                  <span class=\"token comment\">//9</span>\n                       <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">TownCrier</span>\n<span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">readonly</span> <span class=\"token class-name\">System<span class=\"token punctuation\">.</span>Timers<span class=\"token punctuation\">.</span>Timer</span> _timer<span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">public</span> <span class=\"token function\">TownCrier</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">{</span>\n      _timer <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">System<span class=\"token punctuation\">.</span>Timers<span class=\"token punctuation\">.</span>Timer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      _timer<span class=\"token punctuation\">.</span>Interval <span class=\"token operator\">=</span> <span class=\"token number\">1000</span><span class=\"token punctuation\">;</span>\n      _timer<span class=\"token punctuation\">.</span>Elapsed <span class=\"token operator\">+=</span> <span class=\"token punctuation\">(</span>sender<span class=\"token punctuation\">,</span> eventArgs<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span>\n          Console<span class=\"token punctuation\">.</span><span class=\"token function\">WriteLine</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"It is {0} and all is well\"</span><span class=\"token punctuation\">,</span> DateTime<span class=\"token punctuation\">.</span>Now<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">public</span> <span class=\"token return-type class-name\"><span class=\"token keyword\">void</span></span> <span class=\"token function\">Start</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">{</span>\n      _timer<span class=\"token punctuation\">.</span><span class=\"token function\">Start</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">public</span> <span class=\"token return-type class-name\"><span class=\"token keyword\">void</span></span> <span class=\"token function\">Stop</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">{</span>\n      Thread<span class=\"token punctuation\">.</span><span class=\"token function\">Sleep</span><span class=\"token punctuation\">(</span><span class=\"token number\">100000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      _timer<span class=\"token punctuation\">.</span><span class=\"token function\">Stop</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n</li>\n</ul>\n<h2 id=\"03topshelf-사용해보기\" style=\"position:relative;\"><a href=\"#03topshelf-%EC%82%AC%EC%9A%A9%ED%95%B4%EB%B3%B4%EA%B8%B0\" aria-label=\"03topshelf 사용해보기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>03.Topshelf 사용해보기</h2>\n<h3 id=\"031-프로젝트-생성후-topshelf패키지-설치\" style=\"position:relative;\"><a href=\"#031-%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B8-%EC%83%9D%EC%84%B1%ED%9B%84-topshelf%ED%8C%A8%ED%82%A4%EC%A7%80-%EC%84%A4%EC%B9%98\" aria-label=\"031 프로젝트 생성후 topshelf패키지 설치 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>03.1 프로젝트 생성후 Topshelf패키지 설치</h3>\n<ul>\n<li>Windows Service로 프로젝트를 생성한다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 890px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 71.00000000000001%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB4UlEQVQ4y3VU2XabUAzk/7+rD21fepqcOPQ0aQzGYV/MYuACnmrkXgeS5kHcVaPRSBdnmiacz2c0TYOu69C2rc65/96MMWrTZDZr2jAMGMcRDg+CIIDruvB8H3EcI4yi26W+HzTgOBrM86JmzKT79J3neRPUoWMYhtjv9yjLEpfLBYtc4n5d18K2VWCu+74X8F5BGID7zIjM5n8+yjDNc8RZhjhNESYJAgnAy0WR43Q6aeRlWZQpZeGcxgCUZwOoTNIEXRJhKDIMeYa5bRTwYbfDITioDLkErapKATiSPdkxAAGtps4ki6fvj/j2ZYcfX108Pb7ieP+CWdgMZkQmzAmWCHMLSiOQZXUtlAUUp9h9hvfwjJe7Xwh/+6j+HGAE0PM90fcVRV4oM6ZPMGpNhhZ4XXHVsDqVSCXlUjRrmxrLRUSXw7IqlVUkVedIQIIVRXFjum6dN0A5yMShrptbD1JwXxgS7Hg8KqBlyZH60ciUdkuZH4pqK2gFnmS/aTukaaY62nTJjgC8t9bvTcNVU66blFX+eXcPz/O0ygRda3ft0WtGvLsBfK+DjcpeS6U3CUZmNMt0XWlrfJLO/97rOsjW4eP7HuUZRlmNpGh07nz2E/iM+TYLo++6buXn0p11/hc3Vjf8DFpCnQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image-20220718134455102\"\n        title=\"image-20220718134455102\"\n        src=\"/static/2a6b0210bc4c3c8c0459dacd9ab37f1c/4ef49/image-20220718134455102.png\"\n        srcset=\"/static/2a6b0210bc4c3c8c0459dacd9ab37f1c/5a46d/image-20220718134455102.png 300w,\n/static/2a6b0210bc4c3c8c0459dacd9ab37f1c/0a47e/image-20220718134455102.png 600w,\n/static/2a6b0210bc4c3c8c0459dacd9ab37f1c/4ef49/image-20220718134455102.png 890w\"\n        sizes=\"(max-width: 890px) 100vw, 890px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 890px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 71.66666666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsTAAALEwEAmpwYAAABZUlEQVQ4y41TybKDIBDM/39jDlmq9LklAioCmsn0GIwxpOodWgaUtnuWg7WWhmEgpRQZranrOur7XlZjjMTx3Hu/IoTwEY/jKDjgUVUVnc8XOh6PVBQFZXku6/V6oSzL6HQ6yR4XIyLRPj5YJrzdblTVNdV1JeS4DNR8BvVt24oDfIcYaqdpSqpdFeZZLpej9AjnXHKfsi0K8bIsSwH+DNII5O8XUnZXQtWqly3NqxJ7iL0PYi2EN7CHyuW9/84hCEECdYil6gysINz+PcI5zw5suiiikBXVdUN3JoYCUSXKUoTTzwp/EJZlRWYY6fF4MOFM8zy/7IYPy0K4IUoWRXPjNqzQaMPN3LH9ns+M2JoSSpGKPeGmbZz0FyBTEafDmDVP+0u/gca249K891bURbvzvFiPld0iEiz78M57bOz9SO1nNjVyaJ2mweRo+msMFY0mB4V9/z0d/wGcod3g6q6MwHL6nhQdQS2AE5VjAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image-20220718134558180\"\n        title=\"image-20220718134558180\"\n        src=\"/static/945fc09360c4922fb77bce2db0440e4b/4ef49/image-20220718134558180.png\"\n        srcset=\"/static/945fc09360c4922fb77bce2db0440e4b/5a46d/image-20220718134558180.png 300w,\n/static/945fc09360c4922fb77bce2db0440e4b/0a47e/image-20220718134558180.png 600w,\n/static/945fc09360c4922fb77bce2db0440e4b/4ef49/image-20220718134558180.png 890w\"\n        sizes=\"(max-width: 890px) 100vw, 890px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<ul>\n<li>\n<p>프로젝트 생성을 하고 프로젝트에서 오른쪽 마우스 버튼 클리</p>\n<ul>\n<li>Manage NuGet Packages 클릭</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 367px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 196.33333333333331%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,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'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image-20220718134158499\"\n        title=\"image-20220718134158499\"\n        src=\"/static/239a9391b80d62cfe5a5a919be7d9e01/46684/image-20220718134158499.png\"\n        srcset=\"/static/239a9391b80d62cfe5a5a919be7d9e01/5a46d/image-20220718134158499.png 300w,\n/static/239a9391b80d62cfe5a5a919be7d9e01/46684/image-20220718134158499.png 367w\"\n        sizes=\"(max-width: 367px) 100vw, 367px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<ul>\n<li>\n<p>topshelf 검색 후 설치</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1200px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 29.666666666666668%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAABfklEQVQY01WRu27UUBCG/UA8A1Iask1egTegpKOAbNikQBR0lCwSECkSHRISySYKQUBDlrD2em3Hdx8fX44v2UhIIH2cOBXFp3/mzGg0/xxj/8zn5ZHH6Q8X349JRI2QLalsSPKGrOj+Iy1acq2JUNhezMpLWDrRoK6fYqxtm7+ew2/Po7VsOnNJY9rITCJTQVspuqqhqxuuVEOv9MCyQ8qaQiNlRRxnpHlFpnPj/rMZm09P2JocM9qZMRofce/JJ0Y635ycsLE9G7j7+JA7Dz/y4MUhq0BgOSFCFFR1hyoUkeUjL2OMvYM5j159YTw9ZXv6md2339h7d8vkzVfGr8/023eevz9nvH/O9MMcmSQkaU6lN2/7a1ReUjqXKD/CEM2awNX3W1pkgT8gbgiDIZZxRJNr64Xkz7rnuu9xvZAwTMlvbGaF3rQc7BZ1i+GmCmsVYFkujhsOzbcaDerpw/tBShBm+rOUHlLrXof5fMGvC4vFwubip4lprnSt5B904qBPg/X7KQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image-20220718134346546\"\n        title=\"image-20220718134346546\"\n        src=\"/static/d4cd7bcb812cb17b1c7fa80c3e28a41d/c1b63/image-20220718134346546.png\"\n        srcset=\"/static/d4cd7bcb812cb17b1c7fa80c3e28a41d/5a46d/image-20220718134346546.png 300w,\n/static/d4cd7bcb812cb17b1c7fa80c3e28a41d/0a47e/image-20220718134346546.png 600w,\n/static/d4cd7bcb812cb17b1c7fa80c3e28a41d/c1b63/image-20220718134346546.png 1200w,\n/static/d4cd7bcb812cb17b1c7fa80c3e28a41d/78612/image-20220718134346546.png 1260w\"\n        sizes=\"(max-width: 1200px) 100vw, 1200px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"032-서비스-테스트를-위한-소스-구현\" style=\"position:relative;\"><a href=\"#032-%EC%84%9C%EB%B9%84%EC%8A%A4-%ED%85%8C%EC%8A%A4%ED%8A%B8%EB%A5%BC-%EC%9C%84%ED%95%9C-%EC%86%8C%EC%8A%A4-%EA%B5%AC%ED%98%84\" aria-label=\"032 서비스 테스트를 위한 소스 구현 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>03.2 서비스 테스트를 위한 소스 구현</h3>\n<ul>\n<li>우선 소스 자체를 입력하고 빌드를 해준다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"csharp\"><pre class=\"language-csharp\"><code class=\"language-csharp\"><span class=\"token keyword\">using</span> <span class=\"token namespace\">Topshelf</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">TownCrier</span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">readonly</span> <span class=\"token class-name\">System<span class=\"token punctuation\">.</span>Timers<span class=\"token punctuation\">.</span>Timer</span> _timer<span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token function\">TownCrier</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">{</span>\n        _timer <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">System<span class=\"token punctuation\">.</span>Timers<span class=\"token punctuation\">.</span>Timer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        _timer<span class=\"token punctuation\">.</span>Interval <span class=\"token operator\">=</span> <span class=\"token number\">1000</span><span class=\"token punctuation\">;</span>\n        _timer<span class=\"token punctuation\">.</span>Elapsed <span class=\"token operator\">+=</span> <span class=\"token punctuation\">(</span>sender<span class=\"token punctuation\">,</span> eventArgs<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span>\n            Console<span class=\"token punctuation\">.</span><span class=\"token function\">WriteLine</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"It is {0} and all is well\"</span><span class=\"token punctuation\">,</span> DateTime<span class=\"token punctuation\">.</span>Now<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token return-type class-name\"><span class=\"token keyword\">void</span></span> <span class=\"token function\">Start</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">{</span>\n        _timer<span class=\"token punctuation\">.</span><span class=\"token function\">Start</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token return-type class-name\"><span class=\"token keyword\">void</span></span> <span class=\"token function\">Stop</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">{</span>\n        Thread<span class=\"token punctuation\">.</span><span class=\"token function\">Sleep</span><span class=\"token punctuation\">(</span><span class=\"token number\">100000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        _timer<span class=\"token punctuation\">.</span><span class=\"token function\">Stop</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Program</span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token return-type class-name\"><span class=\"token keyword\">void</span></span> <span class=\"token function\">Main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token comment\">//TownCrier townCrier = new TownCrier();</span>\n        <span class=\"token comment\">//townCrier.Start();</span>\n\n        <span class=\"token comment\">//Console.ReadLine();</span>\n        <span class=\"token comment\">//townCrier.Stop();</span>\n\n        <span class=\"token class-name\"><span class=\"token keyword\">var</span></span> rc <span class=\"token operator\">=</span> HostFactory<span class=\"token punctuation\">.</span><span class=\"token function\">Run</span><span class=\"token punctuation\">(</span>x <span class=\"token operator\">=></span>                                   <span class=\"token comment\">//1</span>\n        <span class=\"token punctuation\">{</span>\n            x<span class=\"token punctuation\">.</span><span class=\"token generic-method\"><span class=\"token function\">Service</span><span class=\"token generic class-name\"><span class=\"token punctuation\">&lt;</span>TownCrier<span class=\"token punctuation\">></span></span></span><span class=\"token punctuation\">(</span>s <span class=\"token operator\">=></span>                                   <span class=\"token comment\">//2</span>\n            <span class=\"token punctuation\">{</span>\n                s<span class=\"token punctuation\">.</span><span class=\"token function\">ConstructUsing</span><span class=\"token punctuation\">(</span>name <span class=\"token operator\">=></span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">TownCrier</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>                <span class=\"token comment\">//3</span>\n                s<span class=\"token punctuation\">.</span><span class=\"token function\">WhenStarted</span><span class=\"token punctuation\">(</span>tc <span class=\"token operator\">=></span> tc<span class=\"token punctuation\">.</span><span class=\"token function\">Start</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>                         <span class=\"token comment\">//4</span>\n                s<span class=\"token punctuation\">.</span><span class=\"token function\">WhenStopped</span><span class=\"token punctuation\">(</span>tc <span class=\"token operator\">=></span> tc<span class=\"token punctuation\">.</span><span class=\"token function\">Stop</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>                          <span class=\"token comment\">//5</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            x<span class=\"token punctuation\">.</span><span class=\"token function\">RunAsLocalSystem</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>                                       <span class=\"token comment\">//6</span>\n\n            x<span class=\"token punctuation\">.</span><span class=\"token function\">SetDescription</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"ABC Desc Sample Topshelf Host\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>                   <span class=\"token comment\">//7</span>\n            x<span class=\"token punctuation\">.</span><span class=\"token function\">SetDisplayName</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"ABC DisplayName Stuff\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>                                  <span class=\"token comment\">//8</span>\n            x<span class=\"token punctuation\">.</span><span class=\"token function\">SetServiceName</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"ABC ServiceName Stuff\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>                                  <span class=\"token comment\">//9</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>                                                             <span class=\"token comment\">//10</span>\n\n        <span class=\"token class-name\"><span class=\"token keyword\">var</span></span> exitCode <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span><span class=\"token punctuation\">)</span>Convert<span class=\"token punctuation\">.</span><span class=\"token function\">ChangeType</span><span class=\"token punctuation\">(</span>rc<span class=\"token punctuation\">,</span> rc<span class=\"token punctuation\">.</span><span class=\"token function\">GetTypeCode</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  <span class=\"token comment\">//11</span>\n        Environment<span class=\"token punctuation\">.</span>ExitCode <span class=\"token operator\">=</span> exitCode<span class=\"token punctuation\">;</span>\n\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 778px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 83.33333333333334%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAACXBIWXMAAAsTAAALEwEAmpwYAAADLklEQVQ4y42T2VIaQRSG502SigKzIgizyDYMDMomCMjuArK4VKyYMo+Qq7xcXsALq7x3eYI/5xyX8jIXf3UzTX/99/lPK5Wij7IfoBhUUAoCNKt7qJVD+eZncgiyWZRyNJJK2QxK+SKKfhF+Po+A9ubyBWRzeeQLAfbCXSiNwyM0OgM0Gk3UGy3U600091vYb7VRrdWxV62hHFZEJTqoVC6jTAp8OqAU0DwUhaTdCgHPLm+xXF9hOj3C0fEJjknj0QSDwRDj8QQHBx1omo5YTIWmalBVGnULdjCAkfCgxqLyLRaLyboy+/4bP25ucXNzg9vbXzT+xGq1xvzsDIvFEqPxGLphEFQjkIHNja+wnBCLP39huXVEvn0hoCZAnQ5WxqMher0eOp2uuOl0u/T7kNyNMZvNRCcnJ7R2IE63t1NwHA+2m4GdTiOdSkHXdTnQNEwCHi1wSht403w+l3EymSCggMIwRLVahe/7SNFGdpJMpmDbNlzHJrCDNEEZxtc26CbKYrmkuh1TzQYCGo1G6Pf7yGQyIgmA4MlkAltbCZimJeK5ZVmIx+NIJBKiZDIJZTqd4ozqxVdjIKvb7aFSqaBWq4lDbg3H9WjDNkwrDoNqaRi6ODJNU8RzhisMWJLL8/NzccZOuYZdquVgOESrtQ8rnYFXCJGjPnTdHQlARNeU1DkwkkFgcbhYLHB1dYWLiwuBM5hD6BO81SSgl8VOeReFXBaFgk9QDxuRGCmKKIHVNzCH8wG8vLzEer2WdDudjjjs9wnYbiOZSsOmZF3HpSBcuN4OMtkczHhCShCPb4m2qI5y5XeHnDC74zYSIDlsk1MOgVtG0wyRqlL7cLtQm8h3aRuu6duVV6uVADlthnE/tskZwxnIG1V5JfprE5Oi0ehHDd9fyseVGXh9fS01fG9kTp7XWm1ySO3Bf2apOoHl1WjiTKeRJY3NoXDN3q/MYIZy4jxnhw0KhR1FyBG72oxsflIEEVL0bY2dKqenpxIGiyEsPmA+m0sJ+C17FAK/Csd1KBxblLZfxa9G1kie50F5eHjA3d0d7u/v8fT09EnPeHl5wfPzMx4fH/9b/wAeMYUAUc8M+wAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image-20220718140457184\"\n        title=\"image-20220718140457184\"\n        src=\"/static/018c6dd9109f71ac00a079c7047a5d40/20982/image-20220718140457184.png\"\n        srcset=\"/static/018c6dd9109f71ac00a079c7047a5d40/5a46d/image-20220718140457184.png 300w,\n/static/018c6dd9109f71ac00a079c7047a5d40/0a47e/image-20220718140457184.png 600w,\n/static/018c6dd9109f71ac00a079c7047a5d40/20982/image-20220718140457184.png 778w\"\n        sizes=\"(max-width: 778px) 100vw, 778px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<ul>\n<li>관리자 권한으로 실행하고 그 해당 프로젝트 부분으로 간다.</li>\n<li>\n<p>그리고 해당 명령어를 입력</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">.\\TopShelfConsole.exe</code></pre></div>\n<ul>\n<li>동작시키면 아래와 같이 동작</li>\n</ul>\n</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 874px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 17.666666666666668%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAtUlEQVQY03WP2wqCUBBFjwlCGilmZWm+5A3BT8xLV/MSWv3v7pyBIKIeFnteZs0eFg0R/D6A27nYdB7sxoZxMTA9T2FWJvSzTjmrZjSLXNY2rKsF7TCGuWMwMwaDo3JYfI+RPBIEQ8AJKVfNCupRhVRIYHyBZX/IOcUXol36TBHyptveJ6HTOtRqcpoQ2kmjA8peIQkdegvyL7ybR4J1u6a3xSvzekEisSCXMkbliCDRr1YfvABNt4Gx7ATTdwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image-20220718140834678\"\n        title=\"image-20220718140834678\"\n        src=\"/static/6d49f479bbc5d44a8548b55f5a9ef3d5/30c92/image-20220718140834678.png\"\n        srcset=\"/static/6d49f479bbc5d44a8548b55f5a9ef3d5/5a46d/image-20220718140834678.png 300w,\n/static/6d49f479bbc5d44a8548b55f5a9ef3d5/0a47e/image-20220718140834678.png 600w,\n/static/6d49f479bbc5d44a8548b55f5a9ef3d5/30c92/image-20220718140834678.png 874w\"\n        sizes=\"(max-width: 874px) 100vw, 874px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<h3 id=\"033-서비스-설치\" style=\"position:relative;\"><a href=\"#033-%EC%84%9C%EB%B9%84%EC%8A%A4-%EC%84%A4%EC%B9%98\" aria-label=\"033 서비스 설치 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>03.3 서비스 설치</h3>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">.\\TopShelfConsole.exe install</code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 938px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 32%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA7klEQVQY041Rf4uCQBRck9JQb/vlWkFpEV1ZfcXcqzM7Jb2rvu/c7oODCA/6Y1jewM6bmcfW5RrxPcbyZ4mojBCWIYI8QO/cg5u6cFIH3slTr0tzJ+vAyzhs2cDbnsHRkCasow2WMLC42uD9usJKIb5tsL3vMK/m6GZdtA4tMMnqkTzgkfNTH1xt7J/75Eo7sD/bMJSD2g/PnHzionyGsAoxvUyx+F5gcplgWAwppiGNeqGkRuhvFmmAQe5jVIwwLsYkJnJBbvmJU3TtWHdECxL2fw2SBAV8JSi+BB1Dg6vY5odJHTYPTYJ1tF4S/AXFa79lOqEuZAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image-20220718142131571\"\n        title=\"image-20220718142131571\"\n        src=\"/static/261c2e483bae7cab9d78e4a82bc9a62d/dc333/image-20220718142131571.png\"\n        srcset=\"/static/261c2e483bae7cab9d78e4a82bc9a62d/5a46d/image-20220718142131571.png 300w,\n/static/261c2e483bae7cab9d78e4a82bc9a62d/0a47e/image-20220718142131571.png 600w,\n/static/261c2e483bae7cab9d78e4a82bc9a62d/dc333/image-20220718142131571.png 938w\"\n        sizes=\"(max-width: 938px) 100vw, 938px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1200px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 47%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAABa0lEQVQoz32R626DMAyF+/6vtx8d3SiEa8I93CmUM9sTqNWkWYogJ/bnE+cSxgkibXB1A6gkQ2UH2H5C042y6nY4F+uWtMr2bzrvj3Xp+wFZUeHD8RGaGl6cw/VDqEgjSnOUXEwQ/r+5CncVI69bacw535SbmJKazWRgwgUUy7JgmSbs+xOpyfHlOKiqEtv6EI2jKgs4n1cESqHvOuzPJ7rWIk0SzFR7xGXbNjzWFeu6iZDoHMpXmOdF9vu+y7eua7iuiziO0bYtngRsuxaaxjVN85krwJWA/OXQWQnvfieHlSScQNrfbg5838cwDKI3toExhpr/CyzkWlz06tBaC0V6Qlc8gOxaa00Op3fg4wUY64wceiiKQmaLE9jA8zyEUSQQzucmf4A8Cz48nESpoeE7VOyfc/19lEp0n3Ruxvl93yNN0/PK8ihM5wPuNo4jPYqROUXkhHW+Hut5noseBAGaphGdwQw8aln7AXM/sI7cwV93AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image-20220718142332131\"\n        title=\"image-20220718142332131\"\n        src=\"/static/c1833e5355a69f23f7af4eafe2291372/c1b63/image-20220718142332131.png\"\n        srcset=\"/static/c1833e5355a69f23f7af4eafe2291372/5a46d/image-20220718142332131.png 300w,\n/static/c1833e5355a69f23f7af4eafe2291372/0a47e/image-20220718142332131.png 600w,\n/static/c1833e5355a69f23f7af4eafe2291372/c1b63/image-20220718142332131.png 1200w,\n/static/c1833e5355a69f23f7af4eafe2291372/07108/image-20220718142332131.png 1619w\"\n        sizes=\"(max-width: 1200px) 100vw, 1200px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<ul>\n<li>서비스가 생성됨이 확인이됨</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">.\\TopShelfConsole.exe uninstall</code></pre></div>\n<ul>\n<li>위를 하면 삭제됨</li>\n</ul>","frontmatter":{"title":"Topshelf에대한 기능조사와 간단한 서비스생성","date":"July 18, 2022"}}},"pageContext":{"slug":"/PoC/2022-07-18-Topshelf에대한-기능조사와-간단한-서비스생성/","previous":{"fields":{"slug":"/PoC/2022-07-16-gitFlow-VS-Trunk-based-협업방식/"},"frontmatter":{"title":"GitFlow VS Trunk-based 협업방식"}},"next":{"fields":{"slug":"/Algorithm/2022-07-18-2018카카오-[3차]파일명정렬/"},"frontmatter":{"title":"2018카카오 [3차]파일명정렬"}}}},"staticQueryHashes":["2486386679","3128451518"]}