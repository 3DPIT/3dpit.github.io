{"componentChunkName":"component---src-templates-blog-post-js","path":"/PoC/2022-08-03-[HTTP]-WINRM-제어/","result":{"data":{"site":{"siteMetadata":{"title":"3DPIT Study Blog","author":"[KyeongMinPark]","siteUrl":"https://3dpit.github.io","comment":{"disqusShortName":"","utterances":"3dpit/3dpit.github.io"},"sponsor":{"buyMeACoffeeId":""}}},"markdownRemark":{"id":"b0f59c07-694e-5936-8e1a-dbea9f6fea90","excerpt":"2022-08-03-HTTP-WINRM-제어 Summary 목차 Windows 01.WINRM 서비스 실행 | 사전 준비 01.1 마우스를 이용한 실행 01.2 커멘드창을 이용한 실행 02.WINRM 사용하기 02.1 WINRM 사용하기전 설정 명령어 02.2 실제로 원격 제어해보기 윈도우로컬 -> 윈도우(로컬/ 원격) Linux 01.Linux 사전 준비를 위한 패키지 설치 02.WinRM 사용하기 리눅스 -> 윈도우(로컬/ 원격) 03.pwsh입력까지 한번에 동작 Windows 01.WINRM…","html":"<h2 id=\"2022-08-03-http-winrm-제어\" style=\"position:relative;\"><a href=\"#2022-08-03-http-winrm-%EC%A0%9C%EC%96%B4\" aria-label=\"2022 08 03 http winrm 제어 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2022-08-03-[HTTP]-WINRM-제어</h2>\n<blockquote>\n<p>Summary</p>\n<div class=\"gatsby-highlight\" data-language=\"markdown\"><pre class=\"language-markdown\"><code class=\"language-markdown\"><span class=\"token title important\"><span class=\"token punctuation\">#</span> Windows</span>\n<span class=\"token title important\"><span class=\"token punctuation\">#</span> 간단한 명령_self</span>\n<span class=\"token title important\"><span class=\"token punctuation\">##</span> 직접 대화형으로 들어가는 경우</span>\nEnter-PSSession -ComputerName \"Computer IP\"\n\n<span class=\"token title important\"><span class=\"token punctuation\">##</span> 바로 명령으로 동작시키는 경우</span>\nInvoke-Command -ComputerName \"Computer IP\" -ScriptBlock { dir 'C:\\' }\n\n<span class=\"token title important\"><span class=\"token punctuation\">#</span> 간단한 명령_remote</span>\n<span class=\"token title important\"><span class=\"token punctuation\">##</span> 직접 대화형으로 들어가는 경우</span>\nEnter-PSSession -Computername \"Computer IP\" -Authentication Negotiate -Credential \"Username\"\n\n<span class=\"token title important\"><span class=\"token punctuation\">##</span> 바로 명령으로 동작시키는 경우</span>\nInvoke-Command -ComputerName \"Computer IP\" -ScriptBlock { dir 'C:\\' } -Authentication Negotiate -Credential $cred\n\n<span class=\"token title important\"><span class=\"token punctuation\">#</span> 인증까지 하는 명령</span>\n$sessionoptions = (New-PSSessionOption -SkipCACheck -SkipCNCheck)\n$securePassword = ConvertTo-SecureString -AsPlainText -Force \"Password\"\n$cred = New-Object System.Management.Automation.PSCredential \"Username\", $securePassword\nInvoke-Command -ComputerName \"Computer IP\" -ScriptBlock { cmd.exe /c dir } -Authentication Negotiate -Credential $cred -SessionOption $sessionoptions\n\n<span class=\"token title important\"><span class=\"token punctuation\">#</span> Linux</span>\n<span class=\"token title important\"><span class=\"token punctuation\">#</span> 간단한 명령_self</span>\n<span class=\"token title important\"><span class=\"token punctuation\">##</span> 직접 대화형으로 들어가는 경우</span>\nEnter-PSSession -ComputerName 127.0.0.1\n\n<span class=\"token title important\"><span class=\"token punctuation\">##</span> 바로 명령으로 동작시키는 경우</span>\nInvoke-Command -ComputerName 127.0.0.1 -ScriptBlock { dir 'C:\\' }\n\n<span class=\"token title important\"><span class=\"token punctuation\">#</span> 간단한 명령_remote</span>\n<span class=\"token title important\"><span class=\"token punctuation\">##</span> 직접 대화형으로 들어가는 경우</span>\nEnter-PSSession -ComputerName 127.0.0.1 -Authentication Negotiate -Credential $cred\n\n<span class=\"token title important\"><span class=\"token punctuation\">##</span> 바로 명령으로 동작시키는 경우</span>\nInvoke-Command -ComputerName 127.0.0.1 -ScriptBlock { dir 'C:\\' } -Authentication Negotiate -Credential $cred\n\n<span class=\"token title important\"><span class=\"token punctuation\">#</span> 인증까지 하는 명령</span>\n$sessionoptions = (New-PSSessionOption -SkipCACheck -SkipCNCheck) \n$securePassword = ConvertTo-SecureString -AsPlainText -Force password\n$cred = New-Object System.Management.Automation.PSCredential administrator, $securePassword \nInvoke-Command -ComputerName 127.0.0.1 -ScriptBlock { cmd.exe /c dir } -Authentication Negotiate -Credential $cred -SessionOption $sessionoptions\n\n<span class=\"token title important\"><span class=\"token punctuation\">#</span> pwsh 입력 별개</span>\npwsh\n$sessionoptions = (New-PSSessionOption -SkipCACheck -SkipCNCheck) '\n$securePassword = ConvertTo-SecureString -AsPlainText -Force password\n$cred = (New-Object System.Management.Automation.PSCredential km.park,  ConvertTo-SecureString -AsPlainText -Force mirero)\nInvoke-Command -ComputerName 127.0.0.1 -ScriptBlock { cmd.exe /c dir } -Authentication Negotiate -Credential (New-Object System.Management.Automation.PSCredential km.park, (ConvertTo-SecureString -AsPlainText -Force mirero)) -SessionOption (New-PSSessionOption -SkipCACheck -SkipCNCheck)\n<span class=\"token title important\"><span class=\"token punctuation\">#</span> pwsh 입력 한번에</span>\npwsh -Command \"&amp; {Invoke-Command -ComputerName 127.0.0.1 -ScriptBlock { cmd.exe /c dir } -Authentication Negotiate -Credential (New-Object System.Management.Automation.PSCredential km.park, (ConvertTo-SecureString -AsPlainText -Force mirero)) -SessionOption (New-PSSessionOption -SkipCACheck -SkipCNCheck)}\"</code></pre></div>\n</blockquote>\n<h2 id=\"목차\" style=\"position:relative;\"><a href=\"#%EB%AA%A9%EC%B0%A8\" aria-label=\"목차 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>목차</h2>\n<blockquote>\n<p><strong>Windows</strong></p>\n<p>01.WINRM 서비스 실행 | 사전 준비</p>\n<blockquote>\n<p>01.1 마우스를 이용한 실행</p>\n<p>01.2 커멘드창을 이용한 실행</p>\n</blockquote>\n<p>02.WINRM 사용하기</p>\n<blockquote>\n<p>02.1 WINRM 사용하기전 설정 명령어</p>\n<p>02.2 실제로 원격 제어해보기</p>\n<blockquote>\n<p>윈도우로컬 -> 윈도우(로컬/ 원격)</p>\n</blockquote>\n</blockquote>\n<p><strong>Linux</strong></p>\n<p>01.Linux 사전 준비를 위한 패키지 설치</p>\n<p>02.WinRM 사용하기</p>\n<blockquote>\n<p>리눅스 -> 윈도우(로컬/ 원격)</p>\n</blockquote>\n<p>03.pwsh입력까지 한번에 동작</p>\n</blockquote>\n<h1 id=\"windows\" style=\"position:relative;\"><a href=\"#windows\" aria-label=\"windows permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Windows</h1>\n<h2 id=\"01winrm-서비스-실행--사전-준비\" style=\"position:relative;\"><a href=\"#01winrm-%EC%84%9C%EB%B9%84%EC%8A%A4-%EC%8B%A4%ED%96%89--%EC%82%AC%EC%A0%84-%EC%A4%80%EB%B9%84\" aria-label=\"01winrm 서비스 실행  사전 준비 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>01.WINRM 서비스 실행 | 사전 준비</h2>\n<h3 id=\"011-마우스를-이용한-실행\" style=\"position:relative;\"><a href=\"#011-%EB%A7%88%EC%9A%B0%EC%8A%A4%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%9C-%EC%8B%A4%ED%96%89\" aria-label=\"011 마우스를 이용한 실행 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>01.1 마우스를 이용한 실행</h3>\n<ul>\n<li>\n<p>직접 마우스로 실행하는 법</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 396px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 50.66666666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAABeElEQVQoz6VS2WrDQAzc//+h/kAgCYQE05LmcA7fdg7fzmnvVLPB0LeWVjBI65Xk0WjVdOXqrR8jjiJdliWKovgLNP1+v9cqL0qIad11+Kfpqqqg0izXh6bFve10HEcIwxCe58IPApzOZxxPJyRJjOPxiCDwjfd9D77nwRXEcSw1gQ7CSO5OWq2DM96WJapbi493C5ZlYb1eYT6fY7FYIIwi1HWNSsCx6qZGlqWC7HWualCqUtilaQaVZTmenZaZNZrLxRTfbjc0TWPi+/2Otm0NOpGl9z36O1qR51Cus4frujJOgEjo73Y7EdchfZPIhj/h8XjgImQ4vsqlK+35fBpm1+vV+D7xt2A9ZVCRaMTxuCGOaPSSmLowNvp8w/dvfS5Bhlyo8mRTFDdNUwMy5vibjY3BYIBPWYzjOkaW5XKJ8Xgkd1uEkjOZTDAcDjEajjCdzWDb9qsh/0a6BBvyaZC5PFTTPEkSAzJwHMds/nA4gLU8E4yZ/wXapfcmEpdY2wAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image-20220803134136201\"\n        title=\"image-20220803134136201\"\n        src=\"/static/41afc340d9c15dbd6a2f59a59348d982/db910/image-20220803134136201.png\"\n        srcset=\"/static/41afc340d9c15dbd6a2f59a59348d982/5a46d/image-20220803134136201.png 300w,\n/static/41afc340d9c15dbd6a2f59a59348d982/db910/image-20220803134136201.png 396w\"\n        sizes=\"(max-width: 396px) 100vw, 396px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<ul>\n<li><code class=\"language-text\">윈도우키 + R</code> 을 키보드에 입력하여 실행창을 켠다.</li>\n<li><code class=\"language-text\">services.msc</code>를 입력하고 엔터를 누른다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 581px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 65.33333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAACUUlEQVQ4y41T227TQBT0n4OQkHhBSEWAyhtPvHEREoUWaAIVTculCEjaxF7H9vp+i+36ljTOcNamJVQgWHl0vLI9OzPnWLK8GMlpjgbA2QpYrn6v9WKJ+VnzR9QEuhAnGdIkhexXkOwohaJqsG0bFsEwOFzH7arrIY5niGcJYYb5YgE6A81q1aEROyCKYyiTMQYjDskMUmhMgcdV+KYOR2ewNUZ7DaFtYJ4nKJKQWGr8ba3mOQLOcPBVhjRxUjzaZ3h6qOHZRwOPByqeDBief7Hwjp2iN47RJ/SUDDtyfoHXSo43rMCuWmF7GOLFpyke9BmkoZXixpaK61tai1s9D3fex7i9F2FjL8bd/Rk2Bwluvo1wdSfAtVcBruz4uLfn4n5vio3tCR5+cPHym4/NXU1YTsDGJ3CmcmuXWoH/WssSReQg8zndpuS7xFC1IalORE3RwbkJnRrhByGWFLaIW9R1nK0hzXJw04Kq6bBdH1WR4+DEhKT7Cb6PxlBkGYwxyFRVVYWu6yiKsgudOnqBn/s8z+F7XjsdfhBgURc4PKYuT0khm+owOSeVHKc0k2VZoq7r9sNzwstVENq21R1OzuZljv2hDonZEUbHk04hPRTzl2UZqqr6J6FlmZAnEyKdYl7lGAhCHnSDzQ2DTtKJ0IBHVoTKZs3qZcKiKNpvJkQYUO5C4UFr2Y0xPFcoMlQUyo+GmnJpmubX8K6RnStU6N3PR0dthi3hyOgUMlJompwsWFQFqONa9zsG9LJQs04mlogkiiKEYQjbcuhvk9E/kvEDBDjKxPNbwxQAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image-20220803134508455\"\n        title=\"image-20220803134508455\"\n        src=\"/static/0748cdc13bd5282883aa6ab55b00355b/92d15/image-20220803134508455.png\"\n        srcset=\"/static/0748cdc13bd5282883aa6ab55b00355b/5a46d/image-20220803134508455.png 300w,\n/static/0748cdc13bd5282883aa6ab55b00355b/92d15/image-20220803134508455.png 581w\"\n        sizes=\"(max-width: 581px) 100vw, 581px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<ul>\n<li>위와 같은 창이 나오게 되면 <code class=\"language-text\">Windows Remote Management (WS-Management)</code>를 찾아서 시작하면됨</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"012-커멘드창을-이용한-실행\" style=\"position:relative;\"><a href=\"#012-%EC%BB%A4%EB%A9%98%EB%93%9C%EC%B0%BD%EC%9D%84-%EC%9D%B4%EC%9A%A9%ED%95%9C-%EC%8B%A4%ED%96%89\" aria-label=\"012 커멘드창을 이용한 실행 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>01.2 커멘드창을 이용한 실행</h3>\n<ul>\n<li>\n<p>파워셀을 관리자 모드로 실행해준다.</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\"># 시작 유형을 설정해주는 부분\nGet-Service -Name &quot;WinRM&quot; -StartupType Automatic\n\n# WinRM을 실행하는 부분\nStart-Service -Name &quot;WinRM“\n\n# WinRM의 현재 상태를 보는 부분\nGet-Service -Name &quot;WinRM&quot;</code></pre></div>\n</li>\n</ul>\n<h2 id=\"02winrm-사용하기\" style=\"position:relative;\"><a href=\"#02winrm-%EC%82%AC%EC%9A%A9%ED%95%98%EA%B8%B0\" aria-label=\"02winrm 사용하기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>02.WINRM 사용하기</h2>\n<h3 id=\"021-winrm-사용하기전-설정-명령어\" style=\"position:relative;\"><a href=\"#021-winrm-%EC%82%AC%EC%9A%A9%ED%95%98%EA%B8%B0%EC%A0%84-%EC%84%A4%EC%A0%95-%EB%AA%85%EB%A0%B9%EC%96%B4\" aria-label=\"021 winrm 사용하기전 설정 명령어 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>02.1 WINRM 사용하기전 설정 명령어</h3>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\"># 매개변수를 사용하여 동일한 로컬 서브넷의 공용 네트워크에서 원격 액세스를 허용\nEnable-PSRemoting -SkipNetworkProfileCheck –Force\n# 호스트 허용하는부분 현재는 전체 허용\nSet-Item WSMan:\\localhost\\Client\\TrustedHosts -Force -Value *\n# WinRM 재시작\nRestart-Service -Force WinRM\n# listener 확인\nwinrm e winrm/config/listener</code></pre></div>\n<h2 id=\"022-실제로-원격-제어해보기\" style=\"position:relative;\"><a href=\"#022-%EC%8B%A4%EC%A0%9C%EB%A1%9C-%EC%9B%90%EA%B2%A9-%EC%A0%9C%EC%96%B4%ED%95%B4%EB%B3%B4%EA%B8%B0\" aria-label=\"022 실제로 원격 제어해보기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>02.2 실제로 원격 제어해보기</h2>\n<h4 id=\"윈도우로컬---윈도우로컬-원격\" style=\"position:relative;\"><a href=\"#%EC%9C%88%EB%8F%84%EC%9A%B0%EB%A1%9C%EC%BB%AC---%EC%9C%88%EB%8F%84%EC%9A%B0%EB%A1%9C%EC%BB%AC-%EC%9B%90%EA%B2%A9\" aria-label=\"윈도우로컬   윈도우로컬 원격 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>윈도우로컬 -> 윈도우(로컬/ 원격)</h4>\n<ul>\n<li>\n<p>형식</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\"># 간단한 명령_self\n## 직접 대화형으로 들어가는 경우\nEnter-PSSession -ComputerName &quot;Computer IP&quot;\n\n## 바로 명령으로 동작시키는 경우\nInvoke-Command -ComputerName &quot;Computer IP&quot; -ScriptBlock { dir &#39;C:\\&#39; }\n\n# 간단한 명령_remote\n## 직접 대화형으로 들어가는 경우\nEnter-PSSession -Computername &quot;Computer IP&quot; -Authentication Negotiate -Credential &quot;Username&quot;\n\n## 바로 명령으로 동작시키는 경우\nInvoke-Command -ComputerName &quot;Computer IP&quot; -ScriptBlock { dir &#39;C:\\&#39; } -Authentication Negotiate -Credential $cred\n\n# 인증까지 하는 명령\n$sessionoptions = (New-PSSessionOption -SkipCACheck -SkipCNCheck)\n$securePassword = ConvertTo-SecureString -AsPlainText -Force &quot;Password&quot;\n$cred = New-Object System.Management.Automation.PSCredential &quot;Username&quot;, $securePassword\nInvoke-Command -ComputerName &quot;Computer IP&quot; -ScriptBlock { cmd.exe /c dir } -Authentication Negotiate -Credential $cred -SessionOption $sessionoptions</code></pre></div>\n</li>\n<li>\n<p>실제 사용 예시</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\"># 간단한 명령_self\n## 직접 대화형으로 들어가는 경우\nEnter-PSSession -ComputerName 127.0.0.1\n\n## 바로 명령으로 동작시키는 경우\nInvoke-Command -ComputerName 127.0.0.1 -ScriptBlock { dir &#39;C:\\&#39; }\n\n# 간단한 명령_remote\n## 직접 대화형으로 들어가는 경우\nEnter-PSSession -ComputerName 127.0.0.1 -Authentication Negotiate -Credential $cred\n\n## 바로 명령으로 동작시키는 경우\nInvoke-Command -ComputerName 127.0.0.1 -ScriptBlock { dir &#39;C:\\&#39; } -Authentication Negotiate -Credential $cred\n\n# 인증까지 하는 명령\n$sessionoptions = (New-PSSessionOption -SkipCACheck -SkipCNCheck) \n$securePassword = ConvertTo-SecureString -AsPlainText -Force password\n$cred = New-Object System.Management.Automation.PSCredential administrator, $securePassword \nInvoke-Command -ComputerName 127.0.0.1 -ScriptBlock { cmd.exe /c dir } -Authentication Negotiate -Credential $cred -SessionOption $sessionoptions</code></pre></div>\n<ul>\n<li>“Computer IP”: 127.0.0.1</li>\n<li>“Password”: password</li>\n<li>“Username”: administrator</li>\n</ul>\n</li>\n</ul>\n<h1 id=\"linux\" style=\"position:relative;\"><a href=\"#linux\" aria-label=\"linux permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Linux</h1>\n<h2 id=\"01linux-사전-준비를-위한-패키지-설치\" style=\"position:relative;\"><a href=\"#01linux-%EC%82%AC%EC%A0%84-%EC%A4%80%EB%B9%84%EB%A5%BC-%EC%9C%84%ED%95%9C-%ED%8C%A8%ED%82%A4%EC%A7%80-%EC%84%A4%EC%B9%98\" aria-label=\"01linux 사전 준비를 위한 패키지 설치 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>01.Linux 사전 준비를 위한 패키지 설치</h2>\n<ul>\n<li>\n<p>online | 인터넷이 있는 곳 </p>\n<ul>\n<li>powershell 설치</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">sudo apt update\nsudo apt install -y wget apt-transport-https software-properties-common\nsudo wget -q &quot;https://packages.microsoft.com/config/ubuntu/$(lsb_release -rs)/packages-microsoft-prod.deb&quot;\nsudo dpkg -i packages-microsoft-prod.deb\nsudo apt update\nsudo apt install -y powershell\nsudo pwsh</code></pre></div>\n<ul>\n<li>ntml 설치</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">sudo apt-get update -y\nsudo apt-get install -y gss-ntlmssp</code></pre></div>\n</li>\n<li>\n<p>offlilne | 인터넷이 없는 곳</p>\n<ul>\n<li>패키지를 미리 다운 받아 놓은 것을 올린다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">dpkg -i *.deb</code></pre></div>\n</li>\n</ul>\n<h2 id=\"02winrm-사용하기-1\" style=\"position:relative;\"><a href=\"#02winrm-%EC%82%AC%EC%9A%A9%ED%95%98%EA%B8%B0-1\" aria-label=\"02winrm 사용하기 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>02.WinRM 사용하기</h2>\n<h4 id=\"리눅스---윈도우로컬-원격\" style=\"position:relative;\"><a href=\"#%EB%A6%AC%EB%88%85%EC%8A%A4---%EC%9C%88%EB%8F%84%EC%9A%B0%EB%A1%9C%EC%BB%AC-%EC%9B%90%EA%B2%A9\" aria-label=\"리눅스   윈도우로컬 원격 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>리눅스 -> 윈도우(로컬/ 원격)</h4>\n<ul>\n<li>\n<p>형식</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\"># 간단한 명령\n## 직접 대화형으로 들어가는 경우\npwsh\nEnter-PSSession -Computername &quot;Computer IP&quot; -Authentication Negotiate -Credential &quot;Username&quot;\n\n## 바로 명령으로 동작시키는 경우\npwsh\nInvoke-Command -ComputerName &quot;Computer IP&quot; -ScriptBlock { dir &#39;C:\\&#39; }\n\n# 인증까지 하는 명령\npwsh\n$sessionoptions = (New-PSSessionOption -SkipCACheck -SkipCNCheck)\n$securePassword = ConvertTo-SecureString -AsPlainText -Force &quot;Password&quot;\n$cred = New-Object System.Management.Automation.PSCredential &quot;Username&quot;, $securePassword\nInvoke-Command -ComputerName &quot;Computer IP&quot; -ScriptBlock { cmd.exe /c dir } -Authentication Negotiate -Credential $cred -SessionOption $sessionoptions</code></pre></div>\n</li>\n<li>\n<p>실제 사용 예시</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\"># 간단한 명령\n## 직접 대화형으로 들어가는 경우\npwsh\nEnter-PSSession -ComputerName 127.0.0.1 -Authentication Negotiate -Credential administrator\n\n## 바로 명령으로 동작시키는 경우\npwsh\nInvoke-Command -ComputerName 127.0.0.1 -ScriptBlock { dir &#39;C:\\&#39; }\n\n# 인증까지 하는 명령\npwsh\n$sessionoptions = (New-PSSessionOption -SkipCACheck -SkipCNCheck)\n$securePassword = ConvertTo-SecureString -AsPlainText -Force password\n$cred = New-Object System.Management.Automation.PSCredential administrator, $securePassword\nInvoke-Command -ComputerName 127.0.0.1 -ScriptBlock { cmd.exe /c dir } -Authentication Negotiate -Credential $cred -SessionOption $sessionoptions</code></pre></div>\n<ul>\n<li>“Computer IP”: 127.0.0.1</li>\n<li>“Password”: password</li>\n<li>“Username”: administrator</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"03pwsh입력까지-한번에-동작\" style=\"position:relative;\"><a href=\"#03pwsh%EC%9E%85%EB%A0%A5%EA%B9%8C%EC%A7%80-%ED%95%9C%EB%B2%88%EC%97%90-%EB%8F%99%EC%9E%91\" aria-label=\"03pwsh입력까지 한번에 동작 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>03.pwsh입력까지 한번에 동작</h2>\n<ul>\n<li>\n<p>before</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">pwsh\n$sessionoptions = (New-PSSessionOption -SkipCACheck -SkipCNCheck) &#39;\n$securePassword = ConvertTo-SecureString -AsPlainText -Force password\n$cred = (New-Object System.Management.Automation.PSCredential km.park,  ConvertTo-SecureString -AsPlainText -Force mirero)\nInvoke-Command -ComputerName 127.0.0.1 -ScriptBlock { cmd.exe /c dir } -Authentication Negotiate -Credential (New-Object System.Management.Automation.PSCredential km.park, (ConvertTo-SecureString -AsPlainText -Force mirero)) -SessionOption (New-PSSessionOption -SkipCACheck -SkipCNCheck)</code></pre></div>\n</li>\n<li>\n<p>after</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">pwsh -Command &quot;&amp; {Invoke-Command -ComputerName 127.0.0.1 -ScriptBlock { cmd.exe /c dir } -Authentication Negotiate -Credential (New-Object System.Management.Automation.PSCredential km.park, (ConvertTo-SecureString -AsPlainText -Force mirero)) -SessionOption (New-PSSessionOption -SkipCACheck -SkipCNCheck)}&quot;</code></pre></div>\n<ul>\n<li><a href=\"https://docs.microsoft.com/ko-kr/powershell/module/microsoft.powershell.core/about/about_pwsh?view=powershell-7.2\">명령링크 참고</a></li>\n</ul>\n</li>\n</ul>","frontmatter":{"title":"HTTP WINRM 제어","date":"August 03, 2022"}}},"pageContext":{"slug":"/PoC/2022-08-03-[HTTP]-WINRM-제어/","previous":{"fields":{"slug":"/Algorithm/2022-08-02-2022카카오-주차요금계산/"},"frontmatter":{"title":"2022카카오 주차요금계산"}},"next":{"fields":{"slug":"/Algorithm/2022-08-03-카카오-2022-k진수에수소수개수구하기/"},"frontmatter":{"title":"카카오 2022 k진수에수소수개수구하기"}}}},"staticQueryHashes":["2486386679","3128451518"]}