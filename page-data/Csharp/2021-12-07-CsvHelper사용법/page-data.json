{"componentChunkName":"component---src-templates-blog-post-js","path":"/Csharp/2021-12-07-CsvHelper사용법/","result":{"data":{"site":{"siteMetadata":{"title":"3DPIT Study Blog","author":"[KyeongMinPark]","siteUrl":"https://3dpit.github.io","comment":{"disqusShortName":"","utterances":"3dpit/3dpit.github.io"},"sponsor":{"buyMeACoffeeId":""}}},"markdownRemark":{"id":"f3e7f0be-ecdd-5795-ab2d-8dc67d6fb0a4","excerpt":"2021.12.07_CsvHelper사용법 목차 CsvHelper설치 기본소스 결과확인하기 다른 자료형 받아오기 기본예제 내 소스에 적용해보기 결과확인 1. CsvHelper설치  NuGet 패키지 관리 클릭  CsvHelper 검색 후 설치 진행 2. 기본소스 Before After  위와 같이 file.csv파일이 존재해야함 결과 확인하기  기본적인 자료형의 경우는 잘 받아옴 3. 다른 자료형 받아오기  데이터가 enum…","html":"<h2 id=\"20211207_csvhelper사용법\" style=\"position:relative;\"><a href=\"#20211207_csvhelper%EC%82%AC%EC%9A%A9%EB%B2%95\" aria-label=\"20211207_csvhelper사용법 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2021.12.07_CsvHelper사용법</h2>\n<h2 id=\"목차\" style=\"position:relative;\"><a href=\"#%EB%AA%A9%EC%B0%A8\" aria-label=\"목차 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>목차</h2>\n<ol>\n<li>CsvHelper설치</li>\n<li>\n<p>기본소스</p>\n<ul>\n<li>결과확인하기</li>\n</ul>\n</li>\n<li>\n<p>다른 자료형 받아오기</p>\n<ul>\n<li>기본예제</li>\n<li>내 소스에 적용해보기</li>\n<li>결과확인</li>\n</ul>\n</li>\n</ol>\n<h2 id=\"1-csvhelper설치\" style=\"position:relative;\"><a href=\"#1-csvhelper%EC%84%A4%EC%B9%98\" aria-label=\"1 csvhelper설치 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. CsvHelper설치</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 432px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 100.33333333333334%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsTAAALEwEAmpwYAAADLklEQVQ4y4VUu3LcNhTd0p+SLkXGH5JfSJU+bfILaezendPYpSeNx49C9oytkaJd7vIBgiRI8P3cJbiUJ5M5uYC0mpUl2cUZALPE2XPvOReLx0/X+Inw45MNfvhzhUd/nOJj0OGLGsB8Dse2EUUC+3nGvN9jmiaDPe0POD4v1rzAiuf4ZHG8+2DjsyXQb0eM2wGex5BlmbkwDAN2u93N5ftWjUVdVmirCmVRoClq9G0PpRT6voPv+4jj2CAMQloTqK8Ijgn1Hy4cX2KzYfCovDTLweli0w1E2IMT4TiqW+V9D4u2arErYqR8jZC5SJgNL++QdSNEGECmKWbq37Gib2Hx1q1w4mZ49XGNlycWnr9bwWI+mrpEnCSQBMdx0bbtnVLvJfzlBcevf1n47cUSv/8d4OdnFk6DCmpo4TGGWAjqJYeU0ij9HulinhSqpqFLNjarMywvLqi5o/lRkBlZniOhNaXSk0RivHZaPUSoqOll3UIKD569wsZ2EAUBqrKg/IUIwhCu45DDAp7roihLXF5e3snijSkTRSShuMjEgww9CrKDjUeO5yW5zOBzbnoZJzEpTNB1PSa6qNQDCnUsttstZJ7BzwRCzhDICnW3RUQuazIhYoJATlnV6nRO7yPTbTAKs6pBTmSZDKhkG33TUq+2JtghlexQyXVdG1PGcTQXtcIDNNmotLDdlcJRjWjyAmlBPRMhhq6jjxQiUlXSJM3zpenPYb2rbm9Um0kxhOOOyikRFlRywPDmLMDrf1K8P+N4c8pwYkl8ILw/D3Hqt1glE5ZH0OeLWGGdqCtCRYTaGFamZMoaTOQQRY8zy8PS4ThfM5yvXFhehKKbUA0zin5CeQR9roZrl7OyoVclMj1crixM1Kf//v0C16NRjCMawZBWYaJTZBJ1RdGZ94Tpet3fnI1CXXtFDiZ5SGGOzGRU9AJJmZqXRo9eQNnkPDCO6+gcm3Jszq2SvUJHJLgipGDrqGgiTapd1nNdUrAPI/j1I6sTcEOYljWCOgNnHnp6vvQHOsgFmaX3On8aD708t12mTZxXpDAGc23qUWPCLujpP2RO50xD3YsJVwOyw/9oP9GSelD+wgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image-20211207091901259\"\n        title=\"image-20211207091901259\"\n        src=\"/static/3a35c4241f40809734bc745c5a808fac/0e0c3/image-20211207091901259.png\"\n        srcset=\"/static/3a35c4241f40809734bc745c5a808fac/5a46d/image-20211207091901259.png 300w,\n/static/3a35c4241f40809734bc745c5a808fac/0e0c3/image-20211207091901259.png 432w\"\n        sizes=\"(max-width: 432px) 100vw, 432px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<ul>\n<li>NuGet 패키지 관리 클릭</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 805px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 44.66666666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAACKUlEQVQozy2SS08UQRSF+xe4x0Tjxv/ixvgPDJq4MRpjYtiwUgzxEWTtEjcSg4pGAwYGMEriLBhwHObV7+d0Vz+mBwcwbj7vtCxO6nbd6lPnnlPa4o7P/Q8WD9cdHrzvsrFn0u7Z6G6CH5f4SUmQjKraGwwxvER6MboTY3oKy08rGHJ+0tOycowRFZwcn3IyKilGY6J0KAQFYXpEqIZClDHIj0iK3+iGi2l6uH6M7YQYpktPt+n2LTo9E20cxowcn6MoZpyknCaKv2nKidSZG5DbLko3GAchx4OYLB8SpIpMFfjBgCBSJHHKIM4IoxTt7sxLri6scOfFDrcXa9x4XmP66SbXn25wa6Em2GL6WY1r81s8mXuDY+usm/v4ZkBbVHnqiCIvcYNUJinRLt9cQpvd5tLjAy7M7zM112Dq0V61nhdclL1zs3W0e3WuzKxS2I6oyUnTnCwthGwo9ZAwiFFJjrazusur5R9svv7Ex6VV1pfX2H5XY/vtJlsrG3w5+/7+eZefa99IxCLTcolkVKVylJCmglhGVmKDlo//4GVidl+nddgRgw0xWlI2LQxLzO7p4lXEWEJToiYaqOrnUsIsJcBqPUOej9D6QcHXbkLroEm93qDRaNJstmm3+3S7Bq1fHfp9W0hyolCJhx6HrS59SbTT0aVnVrAs77/CVJ7DIBniSqKTTccJcAW27VcwDIcwTETNcTVmIMn2hGxyWW8CqSfkk3MTwn/ZoHAfNEch2gAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image-20211207091851100\"\n        title=\"image-20211207091851100\"\n        src=\"/static/4706c6d068028e2c55e9c878cd863174/c946b/image-20211207091851100.png\"\n        srcset=\"/static/4706c6d068028e2c55e9c878cd863174/5a46d/image-20211207091851100.png 300w,\n/static/4706c6d068028e2c55e9c878cd863174/0a47e/image-20211207091851100.png 600w,\n/static/4706c6d068028e2c55e9c878cd863174/c946b/image-20211207091851100.png 805w\"\n        sizes=\"(max-width: 805px) 100vw, 805px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<ul>\n<li>CsvHelper 검색 후 설치 진행</li>\n</ul>\n<h2 id=\"2-기본소스\" style=\"position:relative;\"><a href=\"#2-%EA%B8%B0%EB%B3%B8%EC%86%8C%EC%8A%A4\" aria-label=\"2 기본소스 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. 기본소스</h2>\n<ul>\n<li>\n<p>Before</p>\n<div class=\"gatsby-highlight\" data-language=\"c#\"><pre class=\"language-c#\"><code class=\"language-c#\">using System;\n\nnamespace csvHelperTest\n{\n  class Program\n  {\n      static void Main(string[] args)\n      {\n          using (var reader = new StreamReader(&quot;path\\\\to\\\\file.csv&quot;))\n          using (var csv = new CsvReader(reader, CultureInfo.InvariantCulture))\n          {\n              csv.Context.RegisterClassMap&lt;FooMap&gt;();\n              var records = csv.GetRecords&lt;Foo&gt;();\n          }\n      }\n  }\n  public class Foo\n  {\n      public int Id { get; set; }\n      public string Name { get; set; }\n  }\n\n  public sealed class FooMap : ClassMap&lt;Foo&gt;\n  {\n      public FooMap()\n      {\n          Map(m =&gt; m.Id);\n          Map(m =&gt; m.Name);\n      }\n  }\n}</code></pre></div>\n</li>\n<li>\n<p>After</p>\n<div class=\"gatsby-highlight\" data-language=\"c#\"><pre class=\"language-c#\"><code class=\"language-c#\">using System;\n\nnamespace csvHelperTest\n{\n  class Program\n  {\n   private string _path = Environment.GetFolderPath(Environment.SpecialFolder.Desktop) + &quot;@/csv/file.csv&quot;;\n      static void Main(string[] args)\n      {\n          using (var reader = new StreamReader(_path))\n          using (var csv = new CsvReader(reader, CultureInfo.InvariantCulture))\n          {\n              csv.Context.RegisterClassMap&lt;FooMap&gt;();\n              var records = csv.GetRecords&lt;Foo&gt;();\n          }\n      }\n  }\n  public class Foo\n  {\n      public int Id { get; set; }\n      public string Name { get; set; }\n  }\n\n  public sealed class FooMap : ClassMap&lt;Foo&gt;\n  {\n      public FooMap()\n      {\n          Map(m =&gt; m.Id);\n          Map(m =&gt; m.Name);\n      }\n  }\n}</code></pre></div>\n</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 36%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAABBElEQVQoz3WS6U7DMBCE8/5vhXiDSlSFJLRJbMcnkKSHcw5rVyCI0pVGXvnH55ldJ3hQy7LEs+0aFEUKrTSEEKhrSaqjlFIwxsJZG/uh90jmecaWJlKAtm0LJTkYZxH45QxqqWEJIgl+qo7QTqEsGYra3IHTNP3TOI7xDOWcxWH3jNPuCSw/4MNqAgmYAJQSyihougsOhbJIrDXozhdcb/436o9CGWPwst/jPc+Rvr2SkxLD0MP7G3qK2HtPvb/3ITJnHK79jBGCs/UMAzDLMlQVw+lY0ggu8Z6CbSoJc1kvY+0wTVNaDCeHAlpf0XVA0yybSjgB15A1MKe4zrm/zz76HPgGIVgagQygZswAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image-20211207092957412\"\n        title=\"image-20211207092957412\"\n        src=\"/static/84c0c375549389decebe28f8a6c53355/f058b/image-20211207092957412.png\"\n        srcset=\"/static/84c0c375549389decebe28f8a6c53355/5a46d/image-20211207092957412.png 300w,\n/static/84c0c375549389decebe28f8a6c53355/0a47e/image-20211207092957412.png 600w,\n/static/84c0c375549389decebe28f8a6c53355/f058b/image-20211207092957412.png 630w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<ul>\n<li>위와 같이 file.csv파일이 존재해야함</li>\n</ul>\n<h3 id=\"결과-확인하기\" style=\"position:relative;\"><a href=\"#%EA%B2%B0%EA%B3%BC-%ED%99%95%EC%9D%B8%ED%95%98%EA%B8%B0\" aria-label=\"결과 확인하기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>결과 확인하기</h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 684px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 42%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAABjUlEQVQoz32RW2sUQRBG52cLEh8UAjEgkSxRn/QH+KDxZV3BSGKibwaCyl7msrMzs3O/9owxRk+qGwze8OEwVdVffVXdYz0+8Rkd+jw4WfPwnSZm7zhi58Dj/hufuy/nbE8W5nxrPOPW/pTdo5CRsHsYGHS89zbk0XGIVWcJZbKGrwp+XMDlufCF70NLlycMVYYqUi66ml7itsj5phrOm9J8mzSizWKTXw4dVlbWnE1dPpyesbAdXG9JmheUVY0tue24OK53zXLpG42ua9ZJSrSOCQXdY1VlgbNK2XrxkRtPP3Fn7HNb2Bx77LxyGL32uDdx2Nifs/F8wc1nM2Eq8dzE2xOPJ+8TebaYg88ZVtcpur7Hkam+v6KXWFPXDSvJszynLCv6YWD4A6V66fHN1rno2rbVhh2tYDsewSr4xbAWQ58kSYxYKfUXujcIAtN3bahkw1YmzWyXMPjd0HWlFobG9F+GGj1U6+I4pmka+ctytaqqZG0PT67907CVw/8ZGY1sFEURRVHIE/SmfgWAh0TLh3HYEQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image-20211207093204300\"\n        title=\"image-20211207093204300\"\n        src=\"/static/0daa72249ce1f007a0d13aeed019c999/2c288/image-20211207093204300.png\"\n        srcset=\"/static/0daa72249ce1f007a0d13aeed019c999/5a46d/image-20211207093204300.png 300w,\n/static/0daa72249ce1f007a0d13aeed019c999/0a47e/image-20211207093204300.png 600w,\n/static/0daa72249ce1f007a0d13aeed019c999/2c288/image-20211207093204300.png 684w\"\n        sizes=\"(max-width: 684px) 100vw, 684px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<ul>\n<li>기본적인 자료형의 경우는 잘 받아옴</li>\n</ul>\n<h2 id=\"3-다른-자료형-받아오기\" style=\"position:relative;\"><a href=\"#3-%EB%8B%A4%EB%A5%B8-%EC%9E%90%EB%A3%8C%ED%98%95-%EB%B0%9B%EC%95%84%EC%98%A4%EA%B8%B0\" aria-label=\"3 다른 자료형 받아오기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3. 다른 자료형 받아오기</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 744px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 36.333333333333336%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAABBUlEQVQoz4VQ2W6DMBDk/7+sb3lolYdCOBx84ILLJRPOqdc0UUTVdqWR1/bO7O4E1g6YpgnzPGPbtl9B0XYNuMghlIaU0kHtEBxaF1BKIbj1BYbBYlkWTyLyuq5Y3X15Ar23bYs8OyML31CXGpUTqUwNLTl4wV1eIeg74wv7vvegfLiNburZN/DiDhRlWeL19IL4fELOMj+lUtJzCE3TINAfJaqq8sUExhjK2uCzrh+r3k9jDMIoBrsKpHGKLGWILwnGkeyi5kCAQ5An5Odd6NlDLxi+I004kkuBNNWIQucpdxt2QNdtCI4kMvYvwSiKYK3Fz9hrHoL4Jgkh/xUkr4//u8SGL9H+HAH1GRkNAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image-20211207094400140\"\n        title=\"image-20211207094400140\"\n        src=\"/static/aa3f972ac11f269d4c822ce702b7b271/cab8c/image-20211207094400140.png\"\n        srcset=\"/static/aa3f972ac11f269d4c822ce702b7b271/5a46d/image-20211207094400140.png 300w,\n/static/aa3f972ac11f269d4c822ce702b7b271/0a47e/image-20211207094400140.png 600w,\n/static/aa3f972ac11f269d4c822ce702b7b271/cab8c/image-20211207094400140.png 744w\"\n        sizes=\"(max-width: 744px) 100vw, 744px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<ul>\n<li>데이터가 enum 타입인 경우</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"c#\"><pre class=\"language-c#\"><code class=\"language-c#\">    public enum ClassInfo\n    {\n        oneGrade,\n        twoGrade,\n        threeGrade\n    }\n    public class Foo\n    {\n        public int Id { get; set; }\n        public string Name { get; set; }\n        public ClassInfo Class { get; set; }\n    }\n    public sealed class FooMap : ClassMap&lt;Foo&gt;\n    {\n        public FooMap()\n        {\n            Map(m =&gt; m.Id);\n            Map(m =&gt; m.Name);\n            Map(m =&gt; m.Class);\n        }\n    }</code></pre></div>\n<h3 id=\"기본예제\" style=\"position:relative;\"><a href=\"#%EA%B8%B0%EB%B3%B8%EC%98%88%EC%A0%9C\" aria-label=\"기본예제 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>기본예제</h3>\n<div class=\"gatsby-highlight\" data-language=\"c#\"><pre class=\"language-c#\"><code class=\"language-c#\">void Main()\n{\n    using (var reader = new StreamReader(&quot;path\\\\to\\\\file.csv&quot;))\n    using (var csv = new CsvReader(reader, CultureInfo.InvariantCulture))\n    {\n        csv.Context.RegisterClassMap&lt;FooMap&gt;();\n        csv.GetRecords&lt;Foo&gt;().ToList().Dump();\n    }\n}\n\npublic class Foo\n{\n    public int Id { get; set; }\n    public string Name { get; set; }\n    public Json Json { get; set; }\n}\n\npublic class Json\n{\n    public string Foo { get; set; }\n}\n\npublic class JsonConverter&lt;T&gt; : DefaultTypeConverter\n{\n    public override object ConvertFromString(string text, IReaderRow row, MemberMapData memberMapData)\n    {\n        return JsonConvert.DeserializeObject&lt;T&gt;(text);\n    }\n\n    public override string ConvertToString(object value, IWriterRow row, MemberMapData memberMapData)\n    {\n        return JsonConvert.SerializeObject(value);\n    }\n}\n\npublic class FooMap : ClassMap&lt;Foo&gt;\n{\n    public FooMap()\n    {\n        Map(m =&gt; m.Id);\n        Map(m =&gt; m.Name);\n        Map(m =&gt; m.Json).TypeConverter&lt;JsonConverter&lt;Json&gt;&gt;();\n    }\n}</code></pre></div>\n<h3 id=\"내-소스에-적용해보기\" style=\"position:relative;\"><a href=\"#%EB%82%B4-%EC%86%8C%EC%8A%A4%EC%97%90-%EC%A0%81%EC%9A%A9%ED%95%B4%EB%B3%B4%EA%B8%B0\" aria-label=\"내 소스에 적용해보기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>내 소스에 적용해보기</h3>\n<h4 id=\"classinfoconverter-class\" style=\"position:relative;\"><a href=\"#classinfoconverter-class\" aria-label=\"classinfoconverter class permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ClassInfoConverter class</h4>\n<ul>\n<li>\n<p>Before</p>\n<div class=\"gatsby-highlight\" data-language=\"c#\"><pre class=\"language-c#\"><code class=\"language-c#\">public class JsonConverter&lt;T&gt; : DefaultTypeConverter\n{\n  public override object ConvertFromString(string text, IReaderRow row, MemberMapData memberMapData)\n  {\n      return JsonConvert.DeserializeObject&lt;T&gt;(text);\n  }\n\n  public override string ConvertToString(object value, IWriterRow row, MemberMapData memberMapData)\n  {\n      return JsonConvert.SerializeObject(value);\n  }\n}</code></pre></div>\n</li>\n<li>\n<p>After</p>\n<div class=\"gatsby-highlight\" data-language=\"c#\"><pre class=\"language-c#\"><code class=\"language-c#\">  public class ClassInfoConverter&lt;T&gt; : DefaultTypeConverter\n  {\n      public override object ConvertFromString(string text, IReaderRow row, MemberMapData memberMapData)\n      {\n         // return ClassInfoConverter.DeserializeObject&lt;T&gt;(text);\n         return Enum.Parse&lt;ClassInfo&gt;(text);\n      }\n\n      public override string ConvertToString(object value, IWriterRow row, MemberMapData memberMapData)\n      {\n          //return ClassInfoConverter.SerializeObject(value);\n          return value.ToString();\n      }\n  }</code></pre></div>\n</li>\n</ul>\n<h4 id=\"foomap-class-변경\" style=\"position:relative;\"><a href=\"#foomap-class-%EB%B3%80%EA%B2%BD\" aria-label=\"foomap class 변경 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>FooMap class 변경</h4>\n<ul>\n<li>\n<p>Before</p>\n<div class=\"gatsby-highlight\" data-language=\"c#\"><pre class=\"language-c#\"><code class=\"language-c#\">  public sealed class FooMap : ClassMap&lt;Foo&gt;\n  {\n      public FooMap()\n      {\n          Map(m =&gt; m.Id);\n          Map(m =&gt; m.Name);\n          Map(m =&gt; m.Class);\n      }\n  }</code></pre></div>\n</li>\n<li>\n<p>After</p>\n<div class=\"gatsby-highlight\" data-language=\"c#\"><pre class=\"language-c#\"><code class=\"language-c#\">  public sealed class FooMap : ClassMap&lt;Foo&gt;\n  {\n      public FooMap()\n      {\n          Map(m =&gt; m.Id);\n          Map(m =&gt; m.Name);\n          Map(m =&gt; m.Class).TypeConverter&lt;ClassInfoConverter&lt;ClassInfo&gt;&gt;();\n      }\n  }</code></pre></div>\n<h3 id=\"결과-확인하기-1\" style=\"position:relative;\"><a href=\"#%EA%B2%B0%EA%B3%BC-%ED%99%95%EC%9D%B8%ED%95%98%EA%B8%B0-1\" aria-label=\"결과 확인하기 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>결과 확인하기</h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 676px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 52.33333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAAByklEQVQoz3WRSW8UMRCF5x9zBy4QCAj+CTc4AaPAGU2kSDOKeslMt9u976u7OxPES5V7hgMKhyfbVeVXX9mrj1cuLtcC734EeM/6GeLt2sOrrw5efxN4+cXCCxLnn3+28OyTgTffvb+6OOlyLfHhSmKVxSGaIgMeJuDPcdHvGXNXo69ydEWKNk/woFraZ6jyjPYdJsofhxZtkej43DU4qp4MywZbw8F2Z2B/ELD3AlFSIEkLHBwPjvD1ekc5zrt8diXVubgjeX4EGcQQMkSWl1ipYaDCAL82W9i2A99PEMU5pIxwfX2DzeZGN3NcHy5pf/CogYRzkisC3N7a2O1MxHGG1UCG0zRR0kEYhri/n+k8om0b+FKirmuMo9KxRdNJyz6OIghXIEliNE1DhEqhrFuY9h5BEGAYFDhWlSUsyyJSH2maou97cPO+X8T7rusoT+Nbtl6rql4IlRpp3CU4jqM2rKsKnuehpPVs9q+UGhDRVEJ4NG5M05wJm4UwJEI+a0IyMg2DioUmfMqQG/GzmKap6/iOJmQqJmSiMyEnuajIiyfNzmJCvseEDRPyo2dZRr8rNQmbnd9n+ZDxP+MqXVMUBX1gi3medewRSu7hKBmWN/IAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image-20211207095858218\"\n        title=\"image-20211207095858218\"\n        src=\"/static/f34ca2934cb6113006ec86e919b0747c/9bb7a/image-20211207095858218.png\"\n        srcset=\"/static/f34ca2934cb6113006ec86e919b0747c/5a46d/image-20211207095858218.png 300w,\n/static/f34ca2934cb6113006ec86e919b0747c/0a47e/image-20211207095858218.png 600w,\n/static/f34ca2934cb6113006ec86e919b0747c/9bb7a/image-20211207095858218.png 676w\"\n        sizes=\"(max-width: 676px) 100vw, 676px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n</li>\n</ul>","frontmatter":{"title":"21-12-07-CsvHelper사용법","date":"December 07, 2021"}}},"pageContext":{"slug":"/Csharp/2021-12-07-CsvHelper사용법/","previous":null,"next":{"fields":{"slug":"/BlogMake/22-03-27-깃블로그만들기/"},"frontmatter":{"title":"22-03-27-깃블로그만들기"}}}},"staticQueryHashes":["2486386679","3128451518"]}