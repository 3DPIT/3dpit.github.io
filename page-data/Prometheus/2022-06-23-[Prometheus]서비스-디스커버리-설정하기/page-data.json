{"componentChunkName":"component---src-templates-blog-post-js","path":"/Prometheus/2022-06-23-[Prometheus]서비스-디스커버리-설정하기/","result":{"data":{"site":{"siteMetadata":{"title":"3DPIT Study Blog","author":"[KyeongMinPark]","siteUrl":"https://3dpit.github.io","comment":{"disqusShortName":"","utterances":"3dpit/3dpit.github.io"},"sponsor":{"buyMeACoffeeId":""}}},"markdownRemark":{"id":"13d9b8f9-9fb1-5781-bca7-eaaaaf799791","excerpt":"2022-06-23-Prometheus서비스-디스커버리-설정하기 목차 01.서비스 디스커버리란? 02.파일 서비스 디스커버리 02.1 relabel 01.서비스 디스커버리란? 타겟 서버에 대한 정보를 가지고 오기 위한 설정 라벨을 통한 타겟 서버 관리 대상서버를 선정하기 위한것 static config는 정적으로 타겟 서버 지정 새로운 서버 삭제 , 수정시  프로메테우스 재기동하는것  리로드하는것 번거로워서 서비스 디스커버리를 이용해서 타겟서버를 관리함 0…","html":"<h2 id=\"2022-06-23-prometheus서비스-디스커버리-설정하기\" style=\"position:relative;\"><a href=\"#2022-06-23-prometheus%EC%84%9C%EB%B9%84%EC%8A%A4-%EB%94%94%EC%8A%A4%EC%BB%A4%EB%B2%84%EB%A6%AC-%EC%84%A4%EC%A0%95%ED%95%98%EA%B8%B0\" aria-label=\"2022 06 23 prometheus서비스 디스커버리 설정하기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2022-06-23-[Prometheus]서비스-디스커버리-설정하기</h2>\n<h2 id=\"목차\" style=\"position:relative;\"><a href=\"#%EB%AA%A9%EC%B0%A8\" aria-label=\"목차 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>목차</h2>\n<blockquote>\n<p>01.서비스 디스커버리란?</p>\n<p>02.파일 서비스 디스커버리</p>\n<blockquote>\n<p>02.1 relabel</p>\n</blockquote>\n</blockquote>\n<h2 id=\"01서비스-디스커버리란\" style=\"position:relative;\"><a href=\"#01%EC%84%9C%EB%B9%84%EC%8A%A4-%EB%94%94%EC%8A%A4%EC%BB%A4%EB%B2%84%EB%A6%AC%EB%9E%80\" aria-label=\"01서비스 디스커버리란 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>01.서비스 디스커버리란?</h2>\n<ul>\n<li>타겟 서버에 대한 정보를 가지고 오기 위한 설정</li>\n<li>\n<p>라벨을 통한 타겟 서버 관리</p>\n<ul>\n<li>대상서버를 선정하기 위한것</li>\n<li>static config는 정적으로 타겟 서버 지정</li>\n<li>\n<p>새로운 서버 삭제 , 수정시  프로메테우스 재기동하는것  리로드하는것 번거로워서</p>\n<ul>\n<li>서비스 디스커버리를 이용해서 타겟서버를 관리함</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"02파일-서비스-디스커버리\" style=\"position:relative;\"><a href=\"#02%ED%8C%8C%EC%9D%BC-%EC%84%9C%EB%B9%84%EC%8A%A4-%EB%94%94%EC%8A%A4%EC%BB%A4%EB%B2%84%EB%A6%AC\" aria-label=\"02파일 서비스 디스커버리 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>02.파일 서비스 디스커버리</h2>\n<ul>\n<li>\n<p>라벨적용해서 사용할 수 있음</p>\n<ul>\n<li><a href=\"https://prometheus.io/docs/prometheus/latest/configuration/configuration/\">서비스 디스커버리 링크</a></li>\n</ul>\n</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 970px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 74.33333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsTAAALEwEAmpwYAAACf0lEQVQ4y11T2XLbMBDzJyWOnU7zmknz9Xlo3xvbkqyLInXfklEsJbmZcAahxewuAexy9+v9HT9fXnA4HvHw8IDHx0fsn55wfP5h98PzM/b7PZ7k9+FgITFHxr+9veH19dVC8uV8F0cR4qsH5ftQSkElCX9fodwz4UBdTkjCENoYaK2RyP8Zp7nL9wY5F+wgq22AecK2xqZGaxSRWPR1hX4Y0HXdPWaeb5imGRP3222BrF3XthiLHBh63NbgNMtwDQKEZC+IZOe353mWXdM0MCbFp6fghhplWRKFPd/JnyQKYRKFvCgwjiPSNMWVyX4YIYgoTxukeUlUUDpjcoWqqhCqFMrkzCtR81sU7IZBCmS2+kBZ8zyjazvk+RJYrMktlbR1Y3GjzIKXO0GCs6/hRYZx5VJwZBExdSCzbWWUHLIRYrKVSwURoVb5dV2j5CVBksFXGZKssKxtwds4IIlj293NWJ1ofH6e4HpXnC8XuI6D8+kE53xBwGmQBpW81HFDXFxOSaStiqXgbaEvjZimpdMdGVT0saJs8UbskF0wrUpKXhJ+/Ebw8Qfp3xNqxkiD7wVjdk+k2ILSMa3QZQZtVVpvhZUU65jYk4l45pLZJdBsTMFc8XllKAzEEym4XFAi4yVl1aCoWvpT2ybJxRIjSmRU/NjgGqeIdf5fct/3NvjrksRobYBSiWUv82dfAxvYc2aloBMsDAOOz31sZO42qVtThLE8LSNPSq9PjE9P4horubcqZA797wzFHxmTvh++PKsZOoj4htn9KEbMEYo55HEQWrRikXjIV3LeGIqHXxlKkY2hnCkmphwfQ8mClAwFhmcDbRLPo4QMWcxkxb3gP3yJUMo+k2VpAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image-20220623143517986\"\n        title=\"image-20220623143517986\"\n        src=\"/static/245645355e7cdf60ee17bcbdb2956038/587b0/image-20220623143517986.png\"\n        srcset=\"/static/245645355e7cdf60ee17bcbdb2956038/5a46d/image-20220623143517986.png 300w,\n/static/245645355e7cdf60ee17bcbdb2956038/0a47e/image-20220623143517986.png 600w,\n/static/245645355e7cdf60ee17bcbdb2956038/587b0/image-20220623143517986.png 970w\"\n        sizes=\"(max-width: 970px) 100vw, 970px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<ul>\n<li>\n<p>0개 이상의 static config로 이루어진 파일 목록 읽음</p>\n<ul>\n<li>해당 파일 변경되면 감지해서 즉시 설정으로 적용됨</li>\n</ul>\n</li>\n<li>해당 파일, json, yml, yaml로 쓸 수 있음</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 539px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 18.666666666666668%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAuklEQVQY01WPywqEMAxF3QnqRhHbwoBY8YHW1kep4sL//6s7JMzAzOKQBzc3SXQcB57nwXme2LYN3ntc14V5ntF1HfcIay33mqbhSHPEsiwYxxHTNGEYBkT7vrPBuq4wxoDqEDwLSHzfNw9+TX+N6rqGUgp5niOOY6RpiiiEAIIMSdT3PV7aQUgFUVU8IKWEEIKhnCiKAkmSMGSUZRkTOec+Gy1fxRgHrTVDNS2h99u25UivlWX5Z/TN3+y4ckL3V1PzAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image-20220623143736547\"\n        title=\"image-20220623143736547\"\n        src=\"/static/32f5aea4b8e09de4f48cbfafc308f484/10f9a/image-20220623143736547.png\"\n        srcset=\"/static/32f5aea4b8e09de4f48cbfafc308f484/5a46d/image-20220623143736547.png 300w,\n/static/32f5aea4b8e09de4f48cbfafc308f484/10f9a/image-20220623143736547.png 539w\"\n        sizes=\"(max-width: 539px) 100vw, 539px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<ul>\n<li>\n<p>sd 폴더 생성</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">cd /prometheus/config/\nmkdir sd</code></pre></div>\n</li>\n<li>\n<p>심볼릭 링크 걸기</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">ln -sf</code></pre></div>\n<ul>\n<li>-s 심볼릭 링크 걸리</li>\n<li>-f 기존에 심볼릭 링크로 해당파일이 되어 있어도 원하는 파일로 link함</li>\n</ul>\n</li>\n<li>\n<p>이름 바꿔서 이동</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">mv prometheus.yml static_sd.yml</code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 662px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 12.333333333333332%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAYklEQVQI11WLOwrAIBAFbbUWP5hGcU3UQiy8/9FecCFCimGmGRETYc6JtRZqrdxEhFIKWmvslBJ674gxwhgD5xx7o7WGtfZY+Cuj3A/GGMiZePTe/9hjCIEnKeVBKcV8vf0CWfo00bHOfaYAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image-20220623144246174\"\n        title=\"image-20220623144246174\"\n        src=\"/static/bfd1f3ff5888d9c9f2688281a2066717/be86f/image-20220623144246174.png\"\n        srcset=\"/static/bfd1f3ff5888d9c9f2688281a2066717/5a46d/image-20220623144246174.png 300w,\n/static/bfd1f3ff5888d9c9f2688281a2066717/0a47e/image-20220623144246174.png 600w,\n/static/bfd1f3ff5888d9c9f2688281a2066717/be86f/image-20220623144246174.png 662w\"\n        sizes=\"(max-width: 662px) 100vw, 662px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n</li>\n<li>\n<p>file_sd.yml 작성</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">vim file_sd.yml</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"yml\"><pre class=\"language-yml\"><code class=\"language-yml\"><span class=\"token key atrule\">scrape_configs</span><span class=\"token punctuation\">:</span>\n<span class=\"token punctuation\">-</span> <span class=\"token key atrule\">job_name</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'node_exporter'</span>\n  <span class=\"token key atrule\">follow_redirects</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">true</span>\n  <span class=\"token key atrule\">scrape_interval</span><span class=\"token punctuation\">:</span> 5s\n  <span class=\"token key atrule\">scrape_timeout</span><span class=\"token punctuation\">:</span> 1s\n\n  <span class=\"token key atrule\">file_sd_configs</span><span class=\"token punctuation\">:</span>\n  <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">files</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token string\">'sd/*.yml'</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">ln -sf file_sd.yml prometheus.yml</code></pre></div>\n</li>\n<li>\n<p><strong>수집대상 서버가 명시될 파일</strong></p>\n<p><code class=\"language-text\">vim /sd/localhost.yml</code></p>\n<div class=\"gatsby-highlight\" data-language=\"yml\"><pre class=\"language-yml\"><code class=\"language-yml\"><span class=\"token punctuation\">-</span> <span class=\"token key atrule\">targets</span><span class=\"token punctuation\">:</span>\n<span class=\"token punctuation\">-</span> localhost<span class=\"token punctuation\">:</span><span class=\"token number\">9100</span>\n<span class=\"token key atrule\">labels</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">region</span><span class=\"token punctuation\">:</span> KR\n  <span class=\"token key atrule\">tier</span><span class=\"token punctuation\">:</span> frontend\n  <span class=\"token key atrule\">environment</span><span class=\"token punctuation\">:</span> development\n  <span class=\"token key atrule\">disk</span><span class=\"token punctuation\">:</span> NVMe</code></pre></div>\n</li>\n<li>\n<p>reload 하기</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">curl localhost:9090/-/reload -XPOST -D /dev/stdout</code></pre></div>\n</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 732px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 54.666666666666664%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAACUElEQVQoz52S208TQRSH97/zVRNN1CgoN0GplxBJjL7rC5FLuYghogiCAcRXNUZDBUMixFShsaVXeqOt3ft2d7v7Oa1FE018cCZffjM558ycOWeknivX6L8xSFdvgPauPi4IBk6cYvD4STr7AnT3XaXjUj/nLvZwpq3zL06f72jaAgO3uH7zNtJIcJLxyWnujwYZGhljeHSclZlZVgWzcws8FszOzfPoyTxB4Receii0RXM9zcSDGZ4uLjP37DmSrusUy1Uqsk7lu8xhWaYOGLbL/wzJdlw0y0MxPdQa6DbUrBq5bI5cvoiqKLiO08RpqO8LaOJ4Ho7YN9R13SZSpXTIYS5NNpdn6XOdgurjiVnRDGr+75u9lvrlEn4hS72YxyuV8UslkOWW0UeKpCusf8nxcS9POGOIDOv4Bym03TBWMoWdPoBCATedoabplCIxQttJ9r5lwFJxVQU7lcYW2dm2jTT2oc7FZY/uVZ/AmsvijsX6RpqtUJTSbgRjPyYOTqLF9jErh+xsp+hZgzuvPMY3bDaiGrVUnKqioojySKMhh7MLLnff1NiK6+TLKtmqSU42kQ0TxTCQReOquoFtqoS3E7QtuVxecRh6Z5MryhiJOIqmNestTW26tAuH4fc2r3cNChUVS1fQxVMaDkfIgpou83UnSe9Ln8lNB8PUMXUVdT+OenTgvbcux2bqTIQsIgcqVflnsCy08YQ/kfciVKJxytEEcjyBEouhChoZKqI50qeMy4uw6G5V/Jm6iWlZWP9ClMAWwbauYWktTPOX/QfY6wQM/x1YTQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image-20220623160818902\"\n        title=\"image-20220623160818902\"\n        src=\"/static/98e53a746ce392068e5df59e9525cd6e/d0cc0/image-20220623160818902.png\"\n        srcset=\"/static/98e53a746ce392068e5df59e9525cd6e/5a46d/image-20220623160818902.png 300w,\n/static/98e53a746ce392068e5df59e9525cd6e/0a47e/image-20220623160818902.png 600w,\n/static/98e53a746ce392068e5df59e9525cd6e/d0cc0/image-20220623160818902.png 732w\"\n        sizes=\"(max-width: 732px) 100vw, 732px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<ul>\n<li>status -> service Discovery 에서 확인 할 수 있음</li>\n</ul>\n<h3 id=\"021-relabel\" style=\"position:relative;\"><a href=\"#021-relabel\" aria-label=\"021 relabel permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>02.1 relabel</h3>\n<ul>\n<li>\n<p>before</p>\n<div class=\"gatsby-highlight\" data-language=\"yml\"><pre class=\"language-yml\"><code class=\"language-yml\"><span class=\"token key atrule\">scrape_configs</span><span class=\"token punctuation\">:</span>\n<span class=\"token punctuation\">-</span> <span class=\"token key atrule\">job_name</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'node_exporter'</span>\n  <span class=\"token key atrule\">follow_redirects</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">true</span>\n  <span class=\"token key atrule\">scrape_interval</span><span class=\"token punctuation\">:</span> 5s\n  <span class=\"token key atrule\">scrape_timeout</span><span class=\"token punctuation\">:</span> 1s\n  <span class=\"token key atrule\">file_sd_configs</span><span class=\"token punctuation\">:</span>\n  <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">files</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token string\">'sd/*.yml'</span></code></pre></div>\n</li>\n<li>\n<p>after</p>\n<div class=\"gatsby-highlight\" data-language=\"yml\"><pre class=\"language-yml\"><code class=\"language-yml\"><span class=\"token key atrule\">scrape_configs</span><span class=\"token punctuation\">:</span>\n<span class=\"token punctuation\">-</span> <span class=\"token key atrule\">job_name</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'node_exporter'</span>\n  <span class=\"token key atrule\">follow_redirects</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">true</span>\n  <span class=\"token key atrule\">scrape_interval</span><span class=\"token punctuation\">:</span> 5s\n  <span class=\"token key atrule\">scrape_timeout</span><span class=\"token punctuation\">:</span> 1s\n  \n  <span class=\"token key atrule\">file_sd_configs</span><span class=\"token punctuation\">:</span>\n  <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">files</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token string\">'sd/*.yml'</span>\n    \n  <span class=\"token key atrule\">relabel_configs</span><span class=\"token punctuation\">:</span>\n  <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">source_labels</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'__address__'</span><span class=\"token punctuation\">]</span> <span class=\"token comment\"># 참조하는 레이블</span>\n    <span class=\"token key atrule\">regex</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'(.*):(.*)'</span> <span class=\"token comment\"># host명 : 포트</span>\n    <span class=\"token key atrule\">replacement</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'${1}'</span> <span class=\"token comment\"># 매칭되는 부분의 첫번째를</span>\n    <span class=\"token key atrule\">target_label</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'instance'</span> <span class=\"token comment\">#레이블의 값을 사용하겠음</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">curl localhost:9090/-/reload -XPOST -D /dev/stdout</code></pre></div>\n<ul>\n<li>page reload</li>\n</ul>\n</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 726px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 48.666666666666664%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAABzElEQVQoz52PzWsTQRiH948SBY3aFG2K2lDIofRib969eRMPnqSgePEk/bgIIggimINR0SRqKX40m7TYUG0STRqb3dmv2WySfZxsktZA8ODAwzvzzjO/mdGSqUVm51Kcu3CJ8xcvM6WIxROcic8Qm55VJDh1dpqTscmcOD1FPJFkYekaqcUltHfZPLl8npev3vA2myOby1HQi+ilbfRiKaKg/4ti5BS3dygptHpTUG+5HBo2v1uCSkPQ4f+H5sqAPjULDpxB0w+6dLuT6fVCwpCoTtrXqnu7NKtl0rrNRrUf11OEUXD4N4MWHd/Dsw18Xw7fFI55Wvpri4x+yPtdi19mG9eTWK6MqpQSb4Rat32fz98N0p8a1JsG7aCN43pjnjbzEObX4cpKyJ2Mz9MvLmsfPbb2bTzHxDQFQoioSrW+//gHC/caXH+wz9qLGuUDF8c69rT51Q43nrfZ3HNotiwVInBsgW1ZCIU1xBQWviu4+6RKcrnBrfUK5Z0a0rPVnjjytKuPOtxMB6x+kBQqNq4K6x8Woi+IqI7oX/asILmdCdiqugTSxjAHYQNfBc6tdFh+7fPtpz0WYInj11lidEhEc1t5xvCLR/2h+wfbZME58U2qlQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image-20220623162100747\"\n        title=\"image-20220623162100747\"\n        src=\"/static/d40e3fbac399c26cacc032f55a5cb29d/f8067/image-20220623162100747.png\"\n        srcset=\"/static/d40e3fbac399c26cacc032f55a5cb29d/5a46d/image-20220623162100747.png 300w,\n/static/d40e3fbac399c26cacc032f55a5cb29d/0a47e/image-20220623162100747.png 600w,\n/static/d40e3fbac399c26cacc032f55a5cb29d/f8067/image-20220623162100747.png 726w\"\n        sizes=\"(max-width: 726px) 100vw, 726px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<ul>\n<li>위와 같이 바뀜이 확인됨</li>\n<li>\n<p>target_label: ‘instance’ </p>\n<ul>\n<li>target_label: ‘instance’</li>\n<li>새로운 레이블을 만들기 위해서는 위를 host로 변경해주면됨</li>\n</ul>\n</li>\n</ul>","frontmatter":{"title":"Prometheus 서비스 디스커버리 설정하기","date":"June 23, 2022"}}},"pageContext":{"slug":"/Prometheus/2022-06-23-[Prometheus]서비스-디스커버리-설정하기/","previous":{"fields":{"slug":"/Prometheus/2022-06-22-[Prometheus]Docker를-이용하여-Prometheus설치하기/"},"frontmatter":{"title":"Prometheus Docker를 이용하여 Prometheus설치하기"}},"next":{"fields":{"slug":"/Algorithm/2022-06-23-2017카카오코드예선-카카오프렌즈-컬러링북/"},"frontmatter":{"title":"2017카카오코드예선 카카오프렌즈 컬러링북"}}}},"staticQueryHashes":["2486386679","3128451518"]}