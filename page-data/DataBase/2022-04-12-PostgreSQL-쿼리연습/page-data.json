{"componentChunkName":"component---src-templates-blog-post-js","path":"/DataBase/2022-04-12-PostgreSQL-쿼리연습/","result":{"data":{"site":{"siteMetadata":{"title":"3DPIT Study Blog","author":"[KyeongMinPark]","siteUrl":"https://3dpit.github.io","comment":{"disqusShortName":"","utterances":"3dpit/3dpit.github.io"},"sponsor":{"buyMeACoffeeId":""}}},"markdownRemark":{"id":"ba4d582c-2f5b-5142-834e-2d160cdd3b67","excerpt":"22-04-12-PostgreSQL-쿼리연습 목차 01.Creat table 02.타입 02.1 Json Quert Example 03.Shell 04.DDL 05.Insert 06.SELECT - Alias 06.1 Extract UTC Time 06.2 JSON 06.3 Post List 추출1 06.4 Post List 추출2 06.5 Post List 부분의 문제 07.Update 08.DELETE 09.쿼리 최적화 01.Creat table 검색 속도를 위해서는 INTEGER…","html":"<h2 id=\"22-04-12-postgresql-쿼리연습\" style=\"position:relative;\"><a href=\"#22-04-12-postgresql-%EC%BF%BC%EB%A6%AC%EC%97%B0%EC%8A%B5\" aria-label=\"22 04 12 postgresql 쿼리연습 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>22-04-12-PostgreSQL-쿼리연습</h2>\n<h2 id=\"목차\" style=\"position:relative;\"><a href=\"#%EB%AA%A9%EC%B0%A8\" aria-label=\"목차 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>목차</h2>\n<blockquote>\n<p>01.Creat table</p>\n<p>02.타입</p>\n<blockquote>\n<p>02.1 Json Quert Example</p>\n</blockquote>\n<p>03.Shell</p>\n<p>04.DDL</p>\n<p>05.Insert</p>\n<p>06.SELECT - Alias</p>\n<blockquote>\n<p>06.1 Extract UTC Time</p>\n<p>06.2 JSON</p>\n<p>06.3 Post List 추출1</p>\n<p>06.4 Post List 추출2</p>\n<p>06.5 Post List 부분의 문제</p>\n</blockquote>\n<p>07.Update</p>\n<p>08.DELETE</p>\n<p>09.쿼리 최적화</p>\n</blockquote>\n<h2 id=\"01creat-table\" style=\"position:relative;\"><a href=\"#01creat-table\" aria-label=\"01creat table permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>01.Creat table</h2>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">CREATE</span> <span class=\"token keyword\">TABLE</span> post\n<span class=\"token punctuation\">(</span>\n    id \t\t\t\t<span class=\"token keyword\">SERIAL</span>\t\t\t<span class=\"token keyword\">PRIMARY</span> <span class=\"token keyword\">KEY</span><span class=\"token punctuation\">,</span>\n    <span class=\"token keyword\">type</span>\t\t\t<span class=\"token keyword\">VARCHAR</span><span class=\"token punctuation\">(</span><span class=\"token number\">16</span><span class=\"token punctuation\">)</span> \t<span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">default</span> <span class=\"token string\">'default'</span><span class=\"token punctuation\">,</span>\n    user_id \t\t<span class=\"token keyword\">INTEGER</span> \t\t<span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">references</span> <span class=\"token keyword\">user</span><span class=\"token punctuation\">(</span>id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    title\t\t\t<span class=\"token keyword\">VARCHAR</span><span class=\"token punctuation\">(</span><span class=\"token number\">256</span><span class=\"token punctuation\">)</span>\t<span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span>\n    description\t\t<span class=\"token keyword\">TEXT</span>\t\t\t<span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span>\n    child_count \t<span class=\"token keyword\">INTEGER</span>\t\t\t<span class=\"token operator\">NOT</span> NULLL <span class=\"token keyword\">default</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\n    state\t\t\t<span class=\"token keyword\">VARCHAR</span><span class=\"token punctuation\">(</span><span class=\"token number\">16</span><span class=\"token punctuation\">)</span>\t\t<span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token string\">'open'</span><span class=\"token punctuation\">,</span>\n    mention_users \t<span class=\"token keyword\">INTEGER</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    ip_address\t\t<span class=\"token keyword\">CHAR</span><span class=\"token punctuation\">(</span><span class=\"token number\">15</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    info\t\t\tJSON<span class=\"token punctuation\">,</span>\n    parent\t\t\t<span class=\"token keyword\">references</span> post<span class=\"token punctuation\">(</span>id<span class=\"token punctuation\">)</span>\n    create_time \t<span class=\"token keyword\">TIMESTAMP</span> without <span class=\"token keyword\">time</span> zone <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> defualt<span class=\"token punctuation\">(</span><span class=\"token function\">now</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> at <span class=\"token keyword\">time</span> zone <span class=\"token string\">'utc'</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<ul>\n<li>\n<p>검색 속도를 위해서는 INTEGER로 하고 해당 테이블을 연관 테이블로 매칭하는 것도 방법</p>\n<ul>\n<li>사람이 해당 내역을 알아보려면 계속 쿼리를 해야하고 해당 쿼리에 대한 이득은 크지 않음</li>\n</ul>\n</li>\n<li>\n<p>child_count </p>\n<ul>\n<li>위의 경우 사실상 쿼리를 던져서 추출이 가능</li>\n<li>통계데이터 경우 속도가 느리고 몇개의 데이터가 있는지 항상 보내줘야하는 데이터의 경우 속도를 위해서 데이터를 저장해서 싱크를 맞춰준다.</li>\n</ul>\n</li>\n<li>\n<p>국제화를 하려면 신경 써야하는부분</p>\n<ul>\n<li>언어, 환율, 시간</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"02타입\" style=\"position:relative;\"><a href=\"#02%ED%83%80%EC%9E%85\" aria-label=\"02타입 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>02.타입</h2>\n<ul>\n<li>\n<p>SERIAL :</p>\n<ul>\n<li>Integer, Auto increase</li>\n</ul>\n</li>\n<li>\n<p>References: </p>\n<ul>\n<li>foreign key</li>\n</ul>\n</li>\n<li>\n<p>Integer[]: </p>\n<ul>\n<li>Array - cannot set foreign key</li>\n</ul>\n</li>\n<li>\n<p>Char:</p>\n<ul>\n<li>Static length, more fast varchar</li>\n<li>길이가 고정된 데이터에 사용</li>\n</ul>\n</li>\n<li>\n<p>Json:</p>\n<ul>\n<li>json format, cannot set index</li>\n<li>쿼리로 접근 가능, 인덱스 걸 수 없어서 느림</li>\n<li>분석이 필요없고 클라이언트만 사용하는 데이터 저장하는 것이라면 좋음</li>\n</ul>\n</li>\n<li>\n<p>UTC:</p>\n<ul>\n<li>set without time zone</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"021-json-quert-example\" style=\"position:relative;\"><a href=\"#021-json-quert-example\" aria-label=\"021 json quert example permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>02.1 Json Quert Example</h3>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">UPDATE</span> <span class=\"token keyword\">user</span>\n<span class=\"token keyword\">SET</span> profile_image <span class=\"token operator\">=</span>\n<span class=\"token string\">'{\"lg\"/assets/images/guest_lg.png\",\"md\":\"assets/images/guest_md.png\",\"sm\":\"/assets/images/guest_sm.png\"}'</span>\n<span class=\"token keyword\">WHERE</span> id <span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h2 id=\"03shell\" style=\"position:relative;\"><a href=\"#03shell\" aria-label=\"03shell permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>03.Shell</h2>\n<ul>\n<li>주로 개발에서 사용</li>\n<li>긴급상황 발생 시 실행 할 수 있음</li>\n<li>\n<p><strong>명령</strong></p>\n<ul>\n<li>psql -U <user name> -h <ip address> —dbname=<db name></li>\n<li>터미널에서 위와 같이 사용하면 DB에 접속할 수 있음</li>\n</ul>\n</li>\n<li>\n<p>Shell에서 직접 쿼리를 적을 수 있지만</p>\n<ul>\n<li>\\i명령으로 작성된 쿼리 파일을 읽어서 실행 가능</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"04ddl\" style=\"position:relative;\"><a href=\"#04ddl\" aria-label=\"04ddl permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>04.DDL</h2>\n<ul>\n<li>\n<p>SET, Drop not null</p>\n<ul>\n<li>not null 정책이 변경된 경우</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">ALTER</span> <span class=\"token keyword\">TABLE</span> t_user <span class=\"token keyword\">ALTER</span> <span class=\"token keyword\">COLUMN</span> first_name <span class=\"token keyword\">SET</span> <span class=\"token operator\">not</span> <span class=\"token boolean\">null</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">ALTER</span> <span class=\"token keyword\">TABLE</span> t_user <span class=\"token keyword\">ALTER</span> <span class=\"token keyword\">COLUMN</span> last_name <span class=\"token keyword\">DROP</span> <span class=\"token operator\">not</span> <span class=\"token boolean\">null</span><span class=\"token punctuation\">;</span></code></pre></div>\n</li>\n<li>\n<p>Change column type</p>\n<ul>\n<li>타입형 변경, 문자열 길이 변경시</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">ALTER</span> <span class=\"token keyword\">TABLE</span> t_post <span class=\"token keyword\">ALTER</span> <span class=\"token keyword\">COLUMN</span> title <span class=\"token keyword\">TYPE</span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">256</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n</li>\n<li>\n<p>Change column name</p>\n<ul>\n<li>이름 변경시</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">ALTER</span> <span class=\"token keyword\">TABLE</span> t_user_detail <span class=\"token keyword\">RENAME</span> birth_date <span class=\"token keyword\">TO</span> birth_day<span class=\"token punctuation\">;</span></code></pre></div>\n</li>\n<li>\n<p>Setting default value</p>\n<ul>\n<li>디폴트 값 설정시</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">ALTER</span> <span class=\"token keyword\">TABLE</span> t_signup <span class=\"token keyword\">ALTER</span> <span class=\"token keyword\">COLUMN</span> expire_date <span class=\"token keyword\">SET</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token function\">now</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> at <span class=\"token keyword\">time</span> zone <span class=\"token string\">'utc'</span> <span class=\"token operator\">+</span> <span class=\"token keyword\">time</span> <span class=\"token string\">'00:10:03'</span><span class=\"token punctuation\">;</span></code></pre></div>\n</li>\n<li>\n<p>Create index &#x26; Drop index</p>\n<ul>\n<li>인덱스 생성 삭제</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">CREATE</span> <span class=\"token keyword\">INDEX</span> idx_post_poll <span class=\"token keyword\">ON</span> t_post_poll<span class=\"token punctuation\">(</span>post_id<span class=\"token punctuation\">,</span> poll<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">DROP</span> <span class=\"token keyword\">INDEX</span> idx_post_poll<span class=\"token punctuation\">;</span></code></pre></div>\n</li>\n</ul>\n<h2 id=\"05insert\" style=\"position:relative;\"><a href=\"#05insert\" aria-label=\"05insert permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>05.Insert</h2>\n<ul>\n<li>\n<p>다른 테이블에서 여러 개수의 데이터 입력</p>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token keyword\">user</span><span class=\"token punctuation\">(</span>email<span class=\"token punctuation\">,</span> nickname<span class=\"token punctuation\">)</span>\n\t<span class=\"token keyword\">SELECT</span> email<span class=\"token punctuation\">,</span> nickname\n\t<span class=\"token keyword\">FROM</span> signup\n\t<span class=\"token keyword\">WHERE</span> id <span class=\"token operator\">in</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span><span class=\"token number\">11</span><span class=\"token punctuation\">,</span><span class=\"token number\">12</span><span class=\"token punctuation\">)</span></code></pre></div>\n</li>\n<li>\n<p>데이터가 없다면 입력, 있으면 업데이트 하기</p>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> user_medal_season<span class=\"token punctuation\">(</span>user_id<span class=\"token punctuation\">,</span> medal_point<span class=\"token punctuation\">)</span> <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n\t<span class=\"token keyword\">ON</span> CONFLICT <span class=\"token punctuation\">(</span>user_id<span class=\"token punctuation\">)</span> <span class=\"token keyword\">DO</span> <span class=\"token keyword\">UPDATE</span>\n\t <span class=\"token keyword\">SET</span> medal_point <span class=\"token operator\">=</span> user_medal_season_point <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span></code></pre></div>\n</li>\n<li>\n<p>INSERT와 WITH구문 같이 쓰기</p>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">WITH</span>\n\tdaily_count <span class=\"token keyword\">as</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">SELECT</span> <span class=\"token function\">count</span><span class=\"token punctuation\">(</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">FROM</span> <span class=\"token keyword\">user</span> <span class=\"token keyword\">WHERE</span> <span class=\"token punctuation\">(</span><span class=\"token function\">now</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> at <span class=\"token keyword\">time</span> zone <span class=\"token string\">'utc'</span> <span class=\"token operator\">-</span> <span class=\"token keyword\">interval</span> <span class=\"token string\">'24 hours'</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&lt;</span> last_login_time<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n\tweekly_count <span class=\"token keyword\">as</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">SELECT</span> <span class=\"token function\">count</span><span class=\"token punctuation\">(</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">FROM</span> <span class=\"token keyword\">user</span> <span class=\"token keyword\">WHERE</span> <span class=\"token punctuation\">(</span><span class=\"token function\">now</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> at <span class=\"token keyword\">time</span> zone <span class=\"token string\">'utc'</span> <span class=\"token operator\">-</span> <span class=\"token keyword\">interval</span> <span class=\"token string\">'7 days'</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&lt;</span> last_login_time<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n\ttotal_count <span class=\"token keyword\">as</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">SELECT</span> <span class=\"token function\">count</span><span class=\"token punctuation\">(</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span> FORM <span class=\"token keyword\">user</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> retention_rate<span class=\"token punctuation\">(</span>login_user<span class=\"token punctuation\">,</span> login_user_week<span class=\"token punctuation\">,</span> total_user<span class=\"token punctuation\">,</span> rate<span class=\"token punctuation\">)</span> <span class=\"token keyword\">VALUES</span>\n<span class=\"token punctuation\">(</span><span class=\"token keyword\">SELECT</span> count <span class=\"token keyword\">FROM</span> daily_count<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">(</span><span class=\"token keyword\">SELECT</span> count <span class=\"token keyword\">FROM</span> weekly_count<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">(</span><span class=\"token keyword\">SELECT</span> count <span class=\"token keyword\">FROM</span> total_count<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">(</span><span class=\"token keyword\">SELECT</span> count <span class=\"token keyword\">FROm</span> daily_count<span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">SELECT</span> count::<span class=\"token keyword\">float</span> FORM total_count<span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token number\">100</span></code></pre></div>\n</li>\n</ul>\n<h2 id=\"06select---alias\" style=\"position:relative;\"><a href=\"#06select---alias\" aria-label=\"06select   alias permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>06.SELECT - Alias</h2>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> tb_id <span class=\"token keyword\">as</span> <span class=\"token string\">\"boardId\"</span><span class=\"token punctuation\">,</span>\n\ttc<span class=\"token punctuation\">.</span>id <span class=\"token keyword\">as</span> <span class=\"token string\">\"community Id\"</span>\n\t<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n<span class=\"token keyword\">FROM</span> t_board tb<span class=\"token punctuation\">,</span>\n\t t_community tc\n<span class=\"token keyword\">WHERE</span> tc<span class=\"token punctuation\">.</span>id <span class=\"token operator\">=</span> tb<span class=\"token punctuation\">.</span>community_id\n\t<span class=\"token operator\">AND</span> tc<span class=\"token punctuation\">.</span>name <span class=\"token operator\">=</span> <span class=\"token string\">'3dpit programming'</span>\n\t<span class=\"token operator\">AND</span> tb<span class=\"token punctuation\">.</span>name <span class=\"token operator\">=</span> <span class=\"token string\">'qna board'</span><span class=\"token punctuation\">;</span></code></pre></div>\n<ul>\n<li>\n<p>그냥 as boardID로 하면 그냥 소문자로 되고</p>\n<ul>\n<li>as “boardID” 이런식으로 쌍따옴표로 감싸면 대소문자를 구분함</li>\n<li>대게 소문자와 언더바를 이용하는 낙타표현식을 쓰는데 이유는 json으로 바로 만들어서 사용하기 위함</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"061-extract-utc-time\" style=\"position:relative;\"><a href=\"#061-extract-utc-time\" aria-label=\"061 extract utc time permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>06.1 Extract UTC Time</h3>\n<ul>\n<li>\n<p>UTC로 저장된 시간값을 숫자형태로 추출할 때</p>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> email<span class=\"token punctuation\">,</span>\n\t   extract<span class=\"token punctuation\">(</span>epoch <span class=\"token keyword\">from</span> expire_time at <span class=\"token keyword\">time</span> zone <span class=\"token string\">'utc'</span><span class=\"token punctuation\">)</span>::<span class=\"token keyword\">Integer</span> <span class=\"token keyword\">as</span> <span class=\"token string\">\"expireTime\"</span>\n<span class=\"token keyword\">FROM</span> signup\n<span class=\"token keyword\">WHERE</span> id <span class=\"token operator\">=</span> <span class=\"token string\">'clkmnaslnfaefn-39nalfn1209n=ldfoi3n'</span><span class=\"token punctuation\">;</span></code></pre></div>\n<ul>\n<li>extract로 하면 string으로 나오기 때문에 ::Integer를 해줘서 형변환을 해줌</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"062-json\" style=\"position:relative;\"><a href=\"#062-json\" aria-label=\"062 json permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>06.2 JSON</h3>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> tp<span class=\"token punctuation\">.</span>title\n       <span class=\"token punctuation\">,</span>tp<span class=\"token punctuation\">.</span>relative_files\n       <span class=\"token punctuation\">,</span>tf<span class=\"token punctuation\">.</span>info<span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token string\">'imageNames'</span><span class=\"token operator\">-</span><span class=\"token operator\">>></span><span class=\"token string\">'md'</span> <span class=\"token keyword\">as</span> image\n<span class=\"token keyword\">FROM</span> post tp\n\t <span class=\"token keyword\">LEFT</span> <span class=\"token keyword\">JOIN</span> file_info tf <span class=\"token keyword\">ON</span> tf<span class=\"token punctuation\">.</span>id <span class=\"token operator\">=</span> tp<span class=\"token punctuation\">.</span>relative_files<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">WHERE</span> tp<span class=\"token punctuation\">.</span>id <span class=\"token operator\">=</span> <span class=\"token number\">198</span></code></pre></div>\n<h3 id=\"063-post-list-추출1\" style=\"position:relative;\"><a href=\"#063-post-list-%EC%B6%94%EC%B6%9C1\" aria-label=\"063 post list 추출1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>06.3 Post List 추출1</h3>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> tp<span class=\"token punctuation\">.</span>id\n\t   <span class=\"token punctuation\">,</span>tu<span class=\"token punctuation\">.</span>id <span class=\"token keyword\">as</span> <span class=\"token string\">\"userId\"</span>\n\t   <span class=\"token punctuation\">,</span>tu<span class=\"token punctuation\">.</span>username\n\t   <span class=\"token punctuation\">,</span>tc<span class=\"token punctuation\">.</span>name <span class=\"token keyword\">as</span> <span class=\"token string\">\"communityName\"</span>\n\t   <span class=\"token punctuation\">,</span>tp<span class=\"token punctuation\">.</span>view_count <span class=\"token keyword\">as</span> <span class=\"token string\">\"viewCount\"</span>\n\t   <span class=\"token punctuation\">,</span>tp<span class=\"token punctuation\">.</span>vote_count <span class=\"token keyword\">as</span> <span class=\"token string\">\"voteCount\"</span>\n\t   <span class=\"token punctuation\">,</span>tp<span class=\"token punctuation\">.</span>comment_count <span class=\"token keyword\">as</span> <span class=\"token string\">\"commentCount\"</span>\n\t   <span class=\"token punctuation\">,</span>tp<span class=\"token punctuation\">.</span><span class=\"token keyword\">point</span></code></pre></div>\n<h3 id=\"064-post-list-추출2\" style=\"position:relative;\"><a href=\"#064-post-list-%EC%B6%94%EC%B6%9C2\" aria-label=\"064 post list 추출2 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>06.4 Post List 추출2</h3>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token punctuation\">,</span><span class=\"token punctuation\">(</span>\n    <span class=\"token keyword\">SELECT</span> row_to_json<span class=\"token punctuation\">(</span>t<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">FROM</span> <span class=\"token punctuation\">(</span>\n        <span class=\"token keyword\">SELECT</span> tpp<span class=\"token punctuation\">.</span>id\n        \t   <span class=\"token punctuation\">,</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">SELECT</span> array_agg<span class=\"token punctuation\">(</span>row_tojson<span class=\"token punctuation\">(</span>t<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">)</span><span class=\"token keyword\">as</span> <span class=\"token string\">\"relatvieFiles\"</span>\n        \t   <span class=\"token punctuation\">,</span>tppu<span class=\"token punctuation\">.</span>username\n               <span class=\"token punctuation\">,</span>tppu<span class=\"token punctuation\">.</span><span class=\"token keyword\">type</span>\n               <span class=\"token punctuation\">,</span>extract<span class=\"token punctuation\">(</span>epoch <span class=\"token keyword\">from</span> tpp<span class=\"token punctuation\">.</span>create_time<span class=\"token punctuation\">)</span>::<span class=\"token keyword\">INTEGER</span> <span class=\"token keyword\">as</span> <span class=\"token string\">\"createTime\"</span>\n               <span class=\"token punctuation\">,</span>tpp<span class=\"token punctuation\">.</span>title\n               <span class=\"token punctuation\">,</span>tpp<span class=\"token punctuation\">.</span>description\n        <span class=\"token keyword\">FROM</span> t_post tpp\n             <span class=\"token punctuation\">,</span>t_user tppu\n        <span class=\"token keyword\">WHERE</span> tpp<span class=\"token punctuation\">.</span>id <span class=\"token operator\">=</span> tp<span class=\"token punctuation\">.</span>parent_post_id\n            <span class=\"token operator\">AND</span> tpp<span class=\"token punctuation\">.</span>user_id <span class=\"token operator\">=</span> tppu<span class=\"token punctuation\">.</span>id\n    <span class=\"token punctuation\">)</span>t\n<span class=\"token punctuation\">)</span><span class=\"token keyword\">as</span> <span class=\"token string\">\"parentPostPreview\"</span></code></pre></div>\n<ul>\n<li>해당 글에 parent가 있다면 부모글에 미리보기 정보를 제공하는것</li>\n<li>중첩쿼리를 작성시 안쪽 쿼리부터 작성</li>\n<li>한개만 있는 경우 <code class=\"language-text\">row_to_json()</code>을 이용</li>\n<li>여러개의 멀티 row가 있다면 array_agg()를 이용해서 json으로 변경해줌</li>\n</ul>\n<h3 id=\"065-post-list-부분의-문제\" style=\"position:relative;\"><a href=\"#065-post-list-%EB%B6%80%EB%B6%84%EC%9D%98-%EB%AC%B8%EC%A0%9C\" aria-label=\"065 post list 부분의 문제 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>06.5 Post List 부분의 문제</h3>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token punctuation\">,</span><span class=\"token punctuation\">(</span>\n\t<span class=\"token keyword\">SELECT</span> <span class=\"token function\">count</span><span class=\"token punctuation\">(</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">FROM</span> t_post\n    <span class=\"token keyword\">WHERE</span> parent_post_id <span class=\"token operator\">=</span> tp<span class=\"token punctuation\">.</span>id\n<span class=\"token punctuation\">)</span><span class=\"token keyword\">as</span> <span class=\"token string\">\"childPostCount\"</span></code></pre></div>\n<ul>\n<li>초기에는 문제가 없으나 통계관련한 메소드의 경우에는 데이터 양이 많아지면 느려짐</li>\n</ul>\n<h2 id=\"07update\" style=\"position:relative;\"><a href=\"#07update\" aria-label=\"07update permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>07.Update</h2>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">UPDATE</span> t_community tc\n<span class=\"token keyword\">SET</span> member_count <span class=\"token operator\">=</span> <span class=\"token keyword\">COALESCE</span><span class=\"token punctuation\">(</span>\n\t<span class=\"token punctuation\">(</span>\n        <span class=\"token keyword\">SELECT</span> <span class=\"token function\">count</span><span class=\"token punctuation\">(</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">FROM</span> t_user_community tuc\n        <span class=\"token keyword\">WHERE</span> tc<span class=\"token punctuation\">.</span>id <span class=\"token operator\">=</span> tuc<span class=\"token punctuation\">.</span>community_id <span class=\"token keyword\">GROUP</span> <span class=\"token keyword\">BY</span> tuc<span class=\"token punctuation\">,</span>community_id\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<ul>\n<li>커뮤니티의 멤버의 회원수 카운트 싱크를 맞춘 쿼리</li>\n<li>각 커뮤니티 마다 카운트가 달라서 COALESCE 함수를 이용하여 사용</li>\n</ul>\n<h2 id=\"08delete\" style=\"position:relative;\"><a href=\"#08delete\" aria-label=\"08delete permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>08.DELETE</h2>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">DELETE</span> <span class=\"token keyword\">FROM</span> client_error t\n<span class=\"token keyword\">WHERE</span> <span class=\"token keyword\">exists</span><span class=\"token punctuation\">(</span>\n\t<span class=\"token keyword\">SELECT</span> <span class=\"token boolean\">true</span>\n    <span class=\"token keyword\">FROM</span> client_error t2\n    <span class=\"token keyword\">WHERE</span> t2<span class=\"token punctuation\">.</span>id <span class=\"token operator\">=</span> <span class=\"token number\">3</span>\n    \t<span class=\"token operator\">AND</span> t2<span class=\"token punctuation\">.</span>message <span class=\"token operator\">=</span> t<span class=\"token punctuation\">.</span>message\n    \t<span class=\"token operator\">AND</span> t2<span class=\"token punctuation\">.</span>url <span class=\"token operator\">=</span> t<span class=\"token punctuation\">.</span>url\n    \t<span class=\"token operator\">AND</span> t2<span class=\"token punctuation\">.</span>line_number <span class=\"token operator\">=</span> t<span class=\"token punctuation\">.</span>line_number\n    \t<span class=\"token operator\">AND</span> t2<span class=\"token punctuation\">.</span>column_number <span class=\"token operator\">=</span> t<span class=\"token punctuation\">.</span>column_number\n<span class=\"token punctuation\">)</span></code></pre></div>\n<h2 id=\"09쿼리-최적화\" style=\"position:relative;\"><a href=\"#09%EC%BF%BC%EB%A6%AC-%EC%B5%9C%EC%A0%81%ED%99%94\" aria-label=\"09쿼리 최적화 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>09.쿼리 최적화</h2>\n<ul>\n<li>일반적으로 인덱스만 조정해도 속도가 빠름</li>\n<li>\n<p>쿼리 시간 확인을 위한 방법 explain</p>\n<ul>\n<li>데이터베이스 마다 explain 사용 방법 상이</li>\n<li>\n<p>PostgreSQL의 경우</p>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">EXPLAIN</span> <span class=\"token keyword\">ANALYZE</span> <span class=\"token operator\">&lt;&lt;</span>QUERY<span class=\"token operator\">>></span></code></pre></div>\n<ul>\n<li>해당 분석을 통해 full scan인지 index scan인지 분석하고 해결</li>\n<li>프로그래밍 기초에서도 언급했듯이 너무 이른 최적화는 하지 않아도 됨</li>\n<li>20ms 이상 속도가 느려질때 분석</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>","frontmatter":{"title":"2022-04-12-PostgresSQL-쿼리연습","date":"April 12, 2022"}}},"pageContext":{"slug":"/DataBase/2022-04-12-PostgreSQL-쿼리연습/","previous":{"fields":{"slug":"/DesignPattern/22-04-11-비지터패턴-4부-자바와스프링에서찾아보는패턴/"},"frontmatter":{"title":"22-04-11-비지터패턴-4부-자바와스프링에서찾아보는패턴"}},"next":{"fields":{"slug":"/DesignPattern/22-04-12-플라이웨이트패턴-1부-패턴소개/"},"frontmatter":{"title":"22-04-12-플라이웨이트패턴-1부-패턴소개"}}}},"staticQueryHashes":["2486386679","3128451518"]}